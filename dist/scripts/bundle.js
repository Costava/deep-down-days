!function(t){function e(s){if(i[s])return i[s].exports;var n=i[s]={exports:{},id:s,loaded:!1};return t[s].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}var n=i(6),a=s(n),o=i(11),r=s(o),h=i(13),l=s(h),u=i(10),d=s(u),c=i(1),p=(s(c),i(17)),f=s(p),m=i(14),g=s(m),y=i(7),v=s(y),w=i(3),b=s(w),x=i(2),C=s(x);console.log("main");var L=new a["default"];L.volume=.5,L.c=document.querySelector(".js-app-canvas"),L.ctx=L.c.getContext("2d"),L.appSpace=document.querySelector(".js-app-space"),L.appContainer=document.querySelector(".js-app-container"),L.appCanvas=document.querySelector(".js-app-canvas"),L.game=new r["default"](L.c,L.ctx),L.game.dieLoop.stopCallback=function(){document.querySelector(".js-level").innerHTML=L.game.level,document.querySelector(".js-kills").innerHTML=L.game.kills;var t=L.game.speed.toFixed(2);0==t&&(t=0),document.querySelector(".js-speed").innerHTML=t,document.querySelector(".js-highest-streak").innerHTML=L.game.highestStreak,createImageBitmap(L.game.c).then(function(t){L.game.finalFrame=t,L.menus.end.show()})},L.game.isDyingCallback=function(){L.audioLoopers.silverAndGold.fadeOut()},L.aspectWidth=5,L.aspectHeight=2,L.game.aspectWidth=L.aspectWidth,L.game.aspectHeight=L.aspectHeight,L.kb=new l["default"](window),L.game.kb=L.kb,L.keys=d["default"],L.game.keys=L.keys,L.resizeTasks.push(L.resizeComponents.bind(L)),L.resizeTasks.push(L.game.handleResize.bind(L.game)),L.bindHandleResize(window),L.resizeComponents(),L.game.handleResize(),L.audioLoadSuccesses=0,L.audioLoadFailures=0,L.totalAudioLoopers=2,L.audioLoopers={},L.audioLoopers.silverAndGold=new v["default"]({urls:["audio/AJ_-_08_-_Silver_and_Gold.ogg","audio/AJ_-_08_-_Silver_and_Gold.m4a"],onload:function(){L.audioLoadSuccesses+=1},onloaderror:function(){L.audioLoadFailures+=1}}),L.audioLoopers.bambooShootsAndLadders=new v["default"]({urls:["audio/Daniela_Salvia_-_04_-_Bamboo_Shoots_and_Ladders.ogg","audio/Daniela_Salvia_-_04_-_Bamboo_Shoots_and_Ladders.m4a"],onload:function(){L.audioLoadSuccesses+=1},onloaderror:function(){L.audioLoadFailures+=1}}),L.mainTitle=document.querySelector(".js-main-title"),L.mainTitleNonNightmareText="<div>Deep Down Days</div>",L.mainTitleNightmareText='<div>Deep Down Days</div><div class="nightmare-subtitle">Nightmare Mode</div>',L.nightmareSVGPath=document.querySelector(".nightmare").querySelector("path"),L.nonNightmareSVGColor="#000000",L.nightmareSVGColor="#ff3333",L.srng=new C["default"](String((new Date).getTime())),L.globalCompositeOperations=["source-over","source-over","source-over","source-over","source-over","lighter","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exculsion","hue","saturation","color","luminosity"],L.GCOsLastIndex=L.globalCompositeOperations.length-1,L.setNonNightmareTitle=function(){L.mainTitle.innerHTML=L.mainTitleNonNightmareText},L.setNightmareTitle=function(){L.mainTitle.innerHTML=L.mainTitleNightmareText},L.nightmareIntervalFunction=function(){L.ctx.globalCompositeOperation=L.globalCompositeOperations[L.srng.randomInt(0,L.GCOsLastIndex)]},L.nightmareIntervalTime=40,L.setNightmareInterval=function(){L.nightmareInterval=window.setInterval(L.nightmareIntervalFunction,L.nightmareIntervalTime)},L.clearNightmareInterval=function(){void 0!=L.nightmareInterval&&window.clearInterval(L.nightmareInterval)},L.turnOnNightmareMode=function(){L.setNightmareTitle(),L.setNightmareInterval(),L.mainTitle.innerHTML=L.mainTitleNightmareText,L.nightmareSVGPath.style.fill=L.nightmareSVGColor,L.nightmareMode=!0,L.game.nightmareMode=!0},L.turnOffNightmareMode=function(){L.setNonNightmareTitle(),L.clearNightmareInterval(),L.mainTitle.innerHTML=L.mainTitleNonNightmareText,L.nightmareSVGPath.style.fill=L.nonNightmareSVGColor,L.ctx.globalCompositeOperation="source-over",L.nightmareMode=!1,L.game.nightmareMode=!1},L.toggleNightmareMode=function(){L.nightmareMode?L.turnOffNightmareMode():L.turnOnNightmareMode()},L.nightmareMode=!1,L.turnOffNightmareMode(),L.useLoadingColorA=!0,L.loadingColorA="rgb(10, 240, 40)",L.loadingColorB="rgb(10, 40, 240)",L.loadingTextElement=document.querySelector(".js-loading-text"),L.loadingMenuWork=function(){this.audioLoadFailures>0?this.loadingTextElement.innerHTML="Failed to load audio.":this.audioLoadSuccesses===this.totalAudioLoopers?(L.loadingMenuLoop.stopCallback=function(){L.menus.loading.hide(),L.menus.main.show()},L.loadingMenuLoop.stop()):(this.useLoadingColorA?this.loadingTextElement.style.color=this.loadingColorA:this.loadingTextElement.style.color=this.loadingColorB,this.useLoadingColorA=!this.useLoadingColorA)},L.loadingMenuLoop=new b["default"](L.loadingMenuWork.bind(L)),L.mainMenuSpeed=.025,L.tileFactor=.5,L.mainMenuTitle=document.querySelector(".js-main-title"),L.mainMenuWork=function(){if(L.mainMenuNewTime=(new Date).getTime(),L.mainMenuTime+=L.mainMenuNewTime-L.mainMenuOldTime,L.mainMenuOldTime=L.mainMenuNewTime,L.mainMenuTime>3600){var t=L.game.srng.randomInt(50,255),e=L.game.srng.randomInt(50,255),i=L.game.srng.randomInt(50,255);L.mainMenuTitle.style.color="rgb("+t+", "+e+", "+i+")",L.game.backdrop=L.game.randomBackdrop(L.game.srng),L.game.bakeBackdrop(L.game.backdrop),L.mainMenuTime=0}L.panelGroupOffset+=L.mainMenuSpeed,L.panelGroupOffset%=L.game.panelGroupWidth,L.tileOffset+=L.mainMenuSpeed*L.tileFactor,L.tileOffset%=L.game.backdrop.tileLength,L.game.ctx.save(),L.game.ctx.translate(-L.panelGroupOffset*L.game.c.height,0),L.game.ctx.drawImage(L.game.panelsC,0,0,L.game.panelsC.width,L.game.panelsC.height,0,0,L.game.panelsC.width,L.game.panelsC.height),L.game.ctx.translate(0,L.game.c.height),L.game.ctx.scale(1,-1),L.game.ctx.drawImage(L.game.panelsC,0,0,L.game.panelsC.width,L.game.panelsC.height,0,0,L.game.panelsC.width,L.game.panelsC.height),L.game.ctx.restore(),L.game.ctx.save(),L.game.ctx.translate(-L.tileOffset*L.game.c.height,0),L.game.ctx.drawImage(L.game.tilesC,0,0,L.game.tilesC.width,L.game.tilesC.height,0,L.game.panelsC.height,L.game.tilesC.width,L.game.tilesC.height),L.game.ctx.restore()},L.mainMenuLoop=new b["default"](L.mainMenuWork.bind(L)),L.menus={},L.menus.loading=new f["default"]("loading",document.querySelector(".js-loading-menu"),1e3,-1e3,[],function(){L.loadingMenuLoop.start()},function(){}),L.menus.main=new f["default"]("main",document.querySelector(".js-main-menu"),1e3,-1e3,[new g["default"](document.querySelector(".js-main-play"),"click",function(){L.mainMenuLoop.stopCallback=function(){L.startInstructions(),L.audioLoopers.silverAndGold.fadeIn(),L.game.startGame(String((new Date).getTime()))},L.menus.main.hide()}),new g["default"](document.querySelector(".js-main-about"),"click",function(){L.menus.about.show()}),new g["default"](document.querySelector(".js-nightmare-wrapper"),"click",function(){L.toggleNightmareMode()}),new g["default"](document.body,"keydown",function(t){l["default"].getKeyIdentifier(t)==L.keys.LEFT.ID?(L.mainMenuLoop.stopCallback=function(){L.startInstructions(),L.audioLoopers.silverAndGold.fadeIn(),L.game.startGame(String((new Date).getTime()))},L.menus.main.hide()):l["default"].getKeyIdentifier(t)==L.keys.RIGHT.ID?L.menus.about.show():l["default"].getKeyIdentifier(t)==L.keys.DOWN.ID&&L.toggleNightmareMode()})],function(){L.mainMenuOldTime=(new Date).getTime(),L.mainMenuTime=0,L.game.srng=new C["default"](String((new Date).getTime())),L.game.backdrop=L.game.randomBackdrop(L.game.srng),L.game.bakeBackdrop(L.game.backdrop),L.panelGroupOffset=0,L.tileOffset=0,L.audioLoopers.bambooShootsAndLadders.fadeIn(),L.mainMenuLoop.start()},function(){L.audioLoopers.bambooShootsAndLadders.fadeOut(),L.mainMenuLoop.stop()}),L.menus.about=new f["default"]("about",document.querySelector(".js-about-menu"),2e3,-1e3,[new g["default"](document.querySelector(".js-about-return"),"click",function(){L.menus.about.hide()}),new g["default"](document.body,"keydown",function(t){(l["default"].getKeyIdentifier(t)==L.keys.CANCEL.ID||l["default"].getKeyIdentifier(t)==L.keys.DOWN.ID)&&L.menus.about.hide()})],function(){L.menus.main.stopListenerSystems()},function(){L.menus.main.startListenerSystems()}),L.menus.end=new f["default"]("end",document.querySelector(".js-end-menu"),2e3,-1e3,[new g["default"](document.querySelector(".js-end-again"),"click",function(){L.menus.end.hide(),L.startInstructions(),L.audioLoopers.silverAndGold.fadeIn(),L.game.startGame(String((new Date).getTime()))}),new g["default"](document.querySelector(".js-end-main"),"click",function(){L.menus.end.hide(),L.menus.main.show()}),new g["default"](document.body,"keydown",function(t){l["default"].getKeyIdentifier(t)==L.keys.LEFT.ID?(L.menus.end.hide(),L.startInstructions(),L.audioLoopers.silverAndGold.fadeIn(),L.game.startGame(String((new Date).getTime()))):(l["default"].getKeyIdentifier(t)==L.keys.CANCEL.ID||l["default"].getKeyIdentifier(t)==L.keys.RIGHT.ID)&&(L.menus.end.hide(),L.menus.main.show())})],function(){window.addEventListener("resize",L.game.drawFinalFrameBound)},function(){window.removeEventListener("resize",L.game.drawFinalFrameBound)}),L.instructions=document.querySelector(".js-instructions"),L.showInstructions=function(){this.instructions.style["margin-top"]="0"},L.hideInstructions=function(){this.instructions.style["margin-top"]="-100%"},L.startInstructions=function(){this.showInstructions(),void 0!=this.instructionsHideTimeout&&clearTimeout(this.instructionsHideTimeout),this.instructionsHideTimeout=setTimeout(function(){this.hideInstructions()}.bind(this),4e3)},L.kb.startListen(),L.menus.loading.show()},function(t,e){"use strict";function i(t,e,i,s){this.r=t,this.g=e,this.b=i,this.a=s}Object.defineProperty(e,"__esModule",{value:!0}),i.random=function(t,e){var s,n=t(0,255),a=t(0,255),o=t(0,255);return s="number"==typeof e?e:1,new i(n,a,o,s)},i.prototype.toString=function(t){return t===!0?"rgb("+this.r+", "+this.g+", "+this.b+")":"rgba("+this.r+", "+this.g+", "+this.b+", "+this.a+")"},i.prototype.inverse=function(t){return t===!0?new i(255-this.r,255-this.g,255-this.b,1-this.a):new i(255-this.r,255-this.g,255-this.b,this.a)},i.prototype.clamp=function(){var t=this.clone();return["r","g","b"].forEach(function(e){t[e]=Math.max(Math.min(t[e],255),0)}),this.a=Math.max(Math.min(this.a,1),0),t},i.prototype.operate=function(t,e){var i=this.clone();return["r","g","b"].forEach(function(e){i[e]=t(i[e])}),e===!0&&(i.a=t(i.a)),i},i.prototype.clone=function(){return new i(this.r,this.g,this.b,this.a)},e["default"]=i},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){this.hashStream=new o["default"](t),void 0===e?this.setResolution(n.DEFAULT_NOMINAL_RESOLUTION):this.setResolution(e)}Object.defineProperty(e,"__esModule",{value:!0});var a=i(12),o=s(a),r=i(16),h=s(r);n.DEFAULT_NOMINAL_RESOLUTION=1e-9,n.prototype.reset=function(){this.hashStream.reset()},n.prototype.setResolution=function(t){if("number"!=typeof t)throw"Non-NumberResolution";if(0>=t)throw"NonpositiveResolution";this.nominalResolution=t;for(var e=1;1/(0,h["default"])(e,16)>this.nominalResolution;)e+=1;this.pullLength=e,this.pullMaxValue=(0,h["default"])(this.pullLength,16),this.actualResolution=1/(0,h["default"])(this.pullLength,16)},n.prototype.random=function(){var t=this.hashStream.getHash(this.pullLength),e=parseInt(t,16);return e/this.pullMaxValue},n.prototype.randomInt=function(t,e){var i=e-t;return Math.round(this.random()*i)+t},n.prototype.randomInRange=function(t,e){var i=e-t;return this.random()*i+t},e["default"]=n},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function n(t){this.work=t,this.looping=!1,this.stopped=!0,this.stopCallback=function(){},this.timestepper=new o["default"](t),this.loopCallBound=this.loopCall.bind(this)}Object.defineProperty(e,"__esModule",{value:!0});var a=i(20),o=s(a);n.prototype.loopCall=function(){this.newTime=(new Date).getTime(),this.dt=this.newTime-this.oldTime,this.timestepper.go(this.dt),this.oldTime=this.newTime,this.looping?window.requestAnimationFrame(this.loopCallBound):(this.stopped=!0,this.stopCallback())},n.prototype.start=function(){this.oldTime=(new Date).getTime(),this.looping=!0,this.stopped=!1,this.loopCallBound()},n.prototype.stop=function(){this.looping=!1},e["default"]=n},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function n(){this.colors=[],this.dims=[],this.aSideDominant=!0,this.bSideDominant=!0,this.rects=[]}Object.defineProperty(e,"__esModule",{value:!0});var a=i(2),o=(s(a),i(1)),r=s(o);n.COLORS_LENGTH=6,n.DIMS_LENGTH=4,n.random=function(t){for(var e=new n,i=0;i<n.COLORS_LENGTH;i++){var s=r["default"].random(t.randomInt.bind(t),1);e.colors.push(s)}for(var i=0;i<n.DIMS_LENGTH;i++)e.dims.push(t.random());return e.aSideDominant=t.random()<.5,e.bSideDominant=t.random()<.5,e.generateRects(),e},n.prototype.generateRects=function(){this.rects=[],this.rects.push({x:0,y:0,width:1,height:1,color:this.colors[0]}),this.rects.push({x:0,y:0,width:.5,height:.5,color:this.colors[1]}),this.rects.push({x:.5,y:.5,width:.5,height:.5,color:this.colors[1]}),[0,.5].forEach(function(t){var e={x:t,y:t,width:.5*this.dims[0],height:.5,color:this.colors[2]},i={x:t,y:t,width:.5,height:.5*this.dims[1],color:this.colors[3]};this.aSideDominant?(this.rects.push(i),this.rects.push(e)):(this.rects.push(e),this.rects.push(i))}.bind(this)),[0,.5].forEach(function(t){var e={x:t,y:.5-t,width:.5*this.dims[2],height:.5,color:this.colors[4]},i={x:t,y:.5-t,width:.5,height:.5*this.dims[3],color:this.colors[5]};this.bSideDominant?(this.rects.push(i),this.rects.push(e)):(this.rects.push(e),this.rects.push(i))}.bind(this))},n.prototype.render=function(t){this.rects.forEach(function(e){t.save(),t.translate(e.x,e.y),t.beginPath(),t.rect(0,0,e.width,e.height),t.fillStyle=e.color.toString(),t.fill(),t.closePath(),t.restore()})},e["default"]=n},function(t,e,i){var s,n,a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};!function(o){if("object"===a(e))t.exports=o();else{s=o,n="function"==typeof s?s.call(e,i,e,t):s,!(void 0!==n&&(t.exports=n))}}(function(t){"use strict";function e(t,e,i,s,n,a){return e=w(w(e,t),w(s,a)),w(e<<n|e>>>32-n,i)}function i(t,i,s,n,a,o,r){return e(i&s|~i&n,t,i,a,o,r)}function s(t,i,s,n,a,o,r){return e(i&n|s&~n,t,i,a,o,r)}function n(t,i,s,n,a,o,r){return e(i^s^n,t,i,a,o,r)}function a(t,i,s,n,a,o,r){return e(s^(i|~n),t,i,a,o,r)}function o(t,e){var o=t[0],r=t[1],h=t[2],l=t[3];o=i(o,r,h,l,e[0],7,-680876936),l=i(l,o,r,h,e[1],12,-389564586),h=i(h,l,o,r,e[2],17,606105819),r=i(r,h,l,o,e[3],22,-1044525330),o=i(o,r,h,l,e[4],7,-176418897),l=i(l,o,r,h,e[5],12,1200080426),h=i(h,l,o,r,e[6],17,-1473231341),r=i(r,h,l,o,e[7],22,-45705983),o=i(o,r,h,l,e[8],7,1770035416),l=i(l,o,r,h,e[9],12,-1958414417),h=i(h,l,o,r,e[10],17,-42063),r=i(r,h,l,o,e[11],22,-1990404162),o=i(o,r,h,l,e[12],7,1804603682),l=i(l,o,r,h,e[13],12,-40341101),h=i(h,l,o,r,e[14],17,-1502002290),r=i(r,h,l,o,e[15],22,1236535329),o=s(o,r,h,l,e[1],5,-165796510),l=s(l,o,r,h,e[6],9,-1069501632),h=s(h,l,o,r,e[11],14,643717713),r=s(r,h,l,o,e[0],20,-373897302),o=s(o,r,h,l,e[5],5,-701558691),l=s(l,o,r,h,e[10],9,38016083),h=s(h,l,o,r,e[15],14,-660478335),r=s(r,h,l,o,e[4],20,-405537848),o=s(o,r,h,l,e[9],5,568446438),l=s(l,o,r,h,e[14],9,-1019803690),h=s(h,l,o,r,e[3],14,-187363961),r=s(r,h,l,o,e[8],20,1163531501),o=s(o,r,h,l,e[13],5,-1444681467),l=s(l,o,r,h,e[2],9,-51403784),h=s(h,l,o,r,e[7],14,1735328473),r=s(r,h,l,o,e[12],20,-1926607734),o=n(o,r,h,l,e[5],4,-378558),l=n(l,o,r,h,e[8],11,-2022574463),h=n(h,l,o,r,e[11],16,1839030562),r=n(r,h,l,o,e[14],23,-35309556),o=n(o,r,h,l,e[1],4,-1530992060),l=n(l,o,r,h,e[4],11,1272893353),h=n(h,l,o,r,e[7],16,-155497632),r=n(r,h,l,o,e[10],23,-1094730640),o=n(o,r,h,l,e[13],4,681279174),l=n(l,o,r,h,e[0],11,-358537222),h=n(h,l,o,r,e[3],16,-722521979),r=n(r,h,l,o,e[6],23,76029189),o=n(o,r,h,l,e[9],4,-640364487),l=n(l,o,r,h,e[12],11,-421815835),h=n(h,l,o,r,e[15],16,530742520),r=n(r,h,l,o,e[2],23,-995338651),o=a(o,r,h,l,e[0],6,-198630844),l=a(l,o,r,h,e[7],10,1126891415),h=a(h,l,o,r,e[14],15,-1416354905),r=a(r,h,l,o,e[5],21,-57434055),o=a(o,r,h,l,e[12],6,1700485571),l=a(l,o,r,h,e[3],10,-1894986606),h=a(h,l,o,r,e[10],15,-1051523),r=a(r,h,l,o,e[1],21,-2054922799),o=a(o,r,h,l,e[8],6,1873313359),l=a(l,o,r,h,e[15],10,-30611744),h=a(h,l,o,r,e[6],15,-1560198380),r=a(r,h,l,o,e[13],21,1309151649),o=a(o,r,h,l,e[4],6,-145523070),l=a(l,o,r,h,e[11],10,-1120210379),h=a(h,l,o,r,e[2],15,718787259),r=a(r,h,l,o,e[9],21,-343485551),t[0]=w(o,t[0]),t[1]=w(r,t[1]),t[2]=w(h,t[2]),t[3]=w(l,t[3])}function r(t){var e,i=[];for(e=0;64>e;e+=4)i[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return i}function h(t){var e,i=[];for(e=0;64>e;e+=4)i[e>>2]=t[e]+(t[e+1]<<8)+(t[e+2]<<16)+(t[e+3]<<24);return i}function l(t){var e,i,s,n,a,h,l=t.length,u=[1732584193,-271733879,-1732584194,271733878];for(e=64;l>=e;e+=64)o(u,r(t.substring(e-64,e)));for(t=t.substring(e-64),i=t.length,s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;i>e;e+=1)s[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(s[e>>2]|=128<<(e%4<<3),e>55)for(o(u,s),e=0;16>e;e+=1)s[e]=0;return n=8*l,n=n.toString(16).match(/(.*?)(.{0,8})$/),a=parseInt(n[2],16),h=parseInt(n[1],16)||0,s[14]=a,s[15]=h,o(u,s),u}function u(t){var e,i,s,n,a,r,l=t.length,u=[1732584193,-271733879,-1732584194,271733878];for(e=64;l>=e;e+=64)o(u,h(t.subarray(e-64,e)));for(t=l>e-64?t.subarray(e-64):new Uint8Array(0),i=t.length,s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;i>e;e+=1)s[e>>2]|=t[e]<<(e%4<<3);if(s[e>>2]|=128<<(e%4<<3),e>55)for(o(u,s),e=0;16>e;e+=1)s[e]=0;return n=8*l,n=n.toString(16).match(/(.*?)(.{0,8})$/),a=parseInt(n[2],16),r=parseInt(n[1],16)||0,s[14]=a,s[15]=r,o(u,s),u}function d(t){var e,i="";for(e=0;4>e;e+=1)i+=b[t>>8*e+4&15]+b[t>>8*e&15];return i}function c(t){var e;for(e=0;e<t.length;e+=1)t[e]=d(t[e]);return t.join("")}function p(t){return/[\u0080-\uFFFF]/.test(t)&&(t=unescape(encodeURIComponent(t))),t}function f(t,e){var i,s=t.length,n=new ArrayBuffer(s),a=new Uint8Array(n);for(i=0;s>i;i+=1)a[i]=t.charCodeAt(i);return e?a:n}function m(t){return String.fromCharCode.apply(null,new Uint8Array(t))}function g(t,e,i){var s=new Uint8Array(t.byteLength+e.byteLength);return s.set(new Uint8Array(t)),s.set(new Uint8Array(e),t.byteLength),i?s:s.buffer}function y(t){var e,i=[],s=t.length;for(e=0;s-1>e;e+=2)i.push(parseInt(t.substr(e,2),16));return String.fromCharCode.apply(String,i)}function v(){this.reset()}var w=function(t,e){return t+e&4294967295},b=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==c(l("hello"))&&(w=function(t,e){var i=(65535&t)+(65535&e),s=(t>>16)+(e>>16)+(i>>16);return s<<16|65535&i}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function e(t,e){return t=0|t||0,0>t?Math.max(t+e,0):Math.min(t,e)}ArrayBuffer.prototype.slice=function(i,s){var n,a,o,r,h=this.byteLength,l=e(i,h),u=h;return s!==t&&(u=e(s,h)),l>u?new ArrayBuffer(0):(n=u-l,a=new ArrayBuffer(n),o=new Uint8Array(a),r=new Uint8Array(this,l,n),o.set(r),a)}}(),v.prototype.append=function(t){return this.appendBinary(p(t)),this},v.prototype.appendBinary=function(t){this._buff+=t,this._length+=t.length;var e,i=this._buff.length;for(e=64;i>=e;e+=64)o(this._hash,r(this._buff.substring(e-64,e)));return this._buff=this._buff.substring(e-64),this},v.prototype.end=function(t){var e,i,s=this._buff,n=s.length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;n>e;e+=1)a[e>>2]|=s.charCodeAt(e)<<(e%4<<3);return this._finish(a,n),i=c(this._hash),t&&(i=y(i)),this.reset(),i},v.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},v.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},v.prototype.setState=function(t){return this._buff=t.buff,this._length=t.length,this._hash=t.hash,this},v.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},v.prototype._finish=function(t,e){var i,s,n,a=e;if(t[a>>2]|=128<<(a%4<<3),a>55)for(o(this._hash,t),a=0;16>a;a+=1)t[a]=0;i=8*this._length,i=i.toString(16).match(/(.*?)(.{0,8})$/),s=parseInt(i[2],16),n=parseInt(i[1],16)||0,t[14]=s,t[15]=n,o(this._hash,t)},v.hash=function(t,e){return v.hashBinary(p(t),e)},v.hashBinary=function(t,e){var i=l(t),s=c(i);return e?y(s):s},v.ArrayBuffer=function(){this.reset()},v.ArrayBuffer.prototype.append=function(t){var e,i=g(this._buff.buffer,t,!0),s=i.length;for(this._length+=t.byteLength,e=64;s>=e;e+=64)o(this._hash,h(i.subarray(e-64,e)));return this._buff=s>e-64?new Uint8Array(i.buffer.slice(e-64)):new Uint8Array(0),this},v.ArrayBuffer.prototype.end=function(t){var e,i,s=this._buff,n=s.length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;n>e;e+=1)a[e>>2]|=s[e]<<(e%4<<3);return this._finish(a,n),i=c(this._hash),t&&(i=y(i)),this.reset(),i},v.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},v.ArrayBuffer.prototype.getState=function(){var t=v.prototype.getState.call(this);return t.buff=m(t.buff),t},v.ArrayBuffer.prototype.setState=function(t){return t.buff=f(t.buff,!0),v.prototype.setState.call(this,t)},v.ArrayBuffer.prototype.destroy=v.prototype.destroy,v.ArrayBuffer.prototype._finish=v.prototype._finish,v.ArrayBuffer.hash=function(t,e){var i=u(new Uint8Array(t)),s=c(i);return e?y(s):s},v})},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function n(){this.resizeTasks=[]}Object.defineProperty(e,"__esModule",{value:!0});var a=i(15),o=s(a);n.prototype.resizeComponents=function(){var t=(0,o["default"])(this.aspectWidth,this.aspectHeight,this.appSpace.offsetWidth,this.appSpace.offsetHeight),e=t.width+"px",i=t.height+"px";this.appContainer.style.width=e,this.appContainer.style.height=i,this.appCanvas.style.width=e,this.appCanvas.style.height=i,this.appCanvas.width=t.width,this.appCanvas.height=t.height},n.prototype.handleResize=function(){for(var t=this.resizeTasks.length,e=0;t>e;e++)this.resizeTasks[e]()},n.prototype.bindHandleResize=function(t){this.bindHandleResizeTarget=t,this.handleResizeBound=this.handleResize.bind(this),this.bindHandleResizeTarget.addEventListener("resize",this.handleResizeBound)},n.prototype.unbindHandleResize=function(){this.bindHandleResizeTarget.removeEventListener("resize",this.handleResizeBound)},e["default"]=n},function(t,e){"use strict";function i(t){this.urls=t.urls,"number"==typeof t.volume&&t.volume>=0&&t.volume<=1?this.volume=t.volume:this.volume=.5,"function"==typeof t.onload?this.onload=t.onload:this.onload=function(){},"function"==typeof t.onloaderror?this.onloaderror=t.onloaderror:this.onloaderror=function(){},"number"==typeof t.fadeInDuration&&t.fadeInDuration>=0?this.fadeInDuration=t.fadeInDuration:this.fadeInDuration=500,"number"==typeof t.fadeOutDuration&&t.fadeOutDuration>=0?this.fadeOutDuration=t.fadeOutDuration:this.fadeOutDuration=600,"function"==typeof t.fadeInCallback?this.fadeInCallback=t.fadeInCallback:this.fadeInCallback=function(){},"function"==typeof t.fadeOutCallback?this.fadeOutCallback=t.fadeOutCallback:this.fadeOutCallback=function(){},this.howl=new Howl({src:this.urls,autoplay:!1,loop:!0,volume:this.volume,onload:this.onload,onloaderror:this.onloaderror}),this.playing=!1,this.fading=!1}Object.defineProperty(e,"__esModule",{value:!0}),i.prototype.play=function(){this.playing||this.fading?console.log("AudioLooper will not play--already playing and/or fading"):(this.playing=!0,this.howl.play())},i.prototype.pause=function(){this.playing&&!this.fading?(this.playing=!1,this.howl.pause()):console.log("AudioLooper will not pause--either not playing or is fading")},i.prototype.stop=function(){this.playing=!1,this.fading=!1,this.howl.stop()},i.prototype.fadeIn=function(){this.playing?console.log("AudioLooper will not fade in--already playing"):(this.howl.volume(0),this.howl.play(),this.howl.off("fade"),this.howl.on("fade",function(){this.fading=!1,this.fadeInCallback()}.bind(this)),this.howl.fade(0,this.volume,this.fadeInDuration),this.playing=!0,this.fading=!0)},i.prototype.fadeOut=function(){this.playing?(this.howl.off("fade"),this.howl.on("fade",function(){this.howl.pause(),this.playing=!1,this.fading=!1,this.fadeOutCallback()}.bind(this)),this.howl.fade(this.howl.volume(),.1,this.fadeOutDuration),this.fading=!0):console.log("AudioLooper will not fade out--not playing")},e["default"]=i},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function n(){this.panelColors=[]}Object.defineProperty(e,"__esModule",{value:!0});var a=i(4);s(a);n.renderPanelGroup=function(t,e){t.save();for(var i=e.panelWidth/e.panelHeight,s=0;s<e.numPanels;s++){var n=s%e.panelColors.length;t.fillStyle=e.panelColors[n].toString(),t.fillRect(s*i,0,i,1)}t.restore()},n.prototype.renderPanelGroup=function(t){n.renderPanelGroup(t,this)},n.renderTileColumn=function(t,e){t.save();var i=1/e.numTileRows;t.scale(i,i);for(var s=0;s<e.numTileRows;s++)e.tile.render(t),t.translate(0,1);t.restore()},n.prototype.renderTileColumn=function(t){n.renderTileColumn(t,this)},e["default"]=n},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=function(t,e,i){return Math.max(Math.min(t,i),e)}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]={LEFT:{ID:37,NAME:"←"},UP:{ID:38,NAME:"↑"},RIGHT:{ID:39,NAME:"→"},DOWN:{ID:40,NAME:"↓"},MOD:{ID:16,NAME:"Shift"},ACTION:{ID:90,NAME:"Z"},ACTION2:{ID:88,NAME:"X"},ACTION3:{ID:67,NAME:"C"},CONFIRM:{ID:32,NAME:"Space"},CONFIRM2:{ID:13,NAME:"Enter"},CANCEL:{ID:27,NAME:"Esc"}}},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){this.c=t,this.ctx=e,this.panelsC=document.createElement("canvas"),this.panelsCtx=this.panelsC.getContext("2d"),this.tilesC=document.createElement("canvas"),this.tilesCtx=this.tilesC.getContext("2d"),this.playerSideLength=.1,this.playerWalkSpeed=.017,this.playerRunSpeed=.029,this.playerXMoveFactor=.6,this.playerAirFactor=.8,this.maxJumpCycles=10,this.jumpRate=.0059,this.fallRate=.003,this.killBounce=.05,this.numPanels={min:3,max:14},this.panelWidthLimits={min:.12,max:.7},this.panelHeightLimits={min:.06,max:.18},this.numTileRows={min:1,max:5},this.tileFactor=.5,this.limits={},this.outCircleFactor=.8,this.overRedOpacityRate=.015,this.fadeInFactor=.9,this.isDyingCallback=function(){},this.nightmareMode=!1,this.gameLoop=new h["default"](this.gameWork.bind(this)),this.dieLoop=new h["default"](this.dieWork.bind(this)),this.fadeInLoop=new h["default"](this.fadeInWork.bind(this)),this.drawFinalFrameBound=this.drawFinalFrame.bind(this)}Object.defineProperty(e,"__esModule",{value:!0});var a=i(19),o=s(a),r=i(3),h=s(r),l=i(2),u=s(l),d=i(9),c=s(d),p=i(1),f=s(p),m=i(4),g=s(m),y=i(8),v=s(y),w=i(18),b=s(w),x=i(21),C=s(x);n.prototype.randomBackdrop=function(t){var e=new v["default"];e.numPanels=t.randomInt(this.numPanels.min,this.numPanels.max);for(var i=0;i<e.numPanels;i++){var s=f["default"].random(t.randomInt.bind(t));e.panelColors.push(s)}return e.panelWidth=t.randomInRange(this.panelWidthLimits.min,this.panelWidthLimits.max),e.panelHeight=t.randomInRange(this.panelHeightLimits.min,this.panelHeightLimits.max),e.numTileRows=t.randomInt(this.numTileRows.min,this.numTileRows.max),e.tileLength=(1-2*e.panelHeight)/e.numTileRows,e.tile=g["default"].random(t),e},n.prototype.bakeBackdrop=function(t){this.panelHeight=Math.round(t.panelHeight*this.c.height),this.tileColumnHeight=this.c.height-2*this.panelHeight,this.panelGroupWidth=t.numPanels*t.panelWidth,this.numPanelGroups=1+Math.ceil(this.aspectWidth/this.aspectHeight/this.panelGroupWidth),this.numTileColumns=1+Math.ceil(this.aspectWidth/this.aspectHeight/t.tileLength),this.panelsC.width=Math.floor(this.numPanelGroups*this.panelGroupWidth*this.c.height),this.panelsC.height=this.panelHeight,this.tilesC.width=Math.floor(this.numTileColumns*t.tileLength*this.c.height),this.tilesC.height=this.tileColumnHeight,this.panelsCtx.save(),this.panelsCtx.scale(this.panelHeight,this.panelHeight);for(var e=t.panelWidth/t.panelHeight*t.numPanels,i=0;i<this.numPanelGroups;i++)t.renderPanelGroup(this.panelsCtx),this.panelsCtx.translate(e,0);this.panelsCtx.restore(),this.tilesCtx.save(),this.tilesCtx.scale(this.tileColumnHeight,this.tileColumnHeight);for(var s=1/t.numTileRows,i=0;i<this.numTileColumns;i++)t.renderTileColumn(this.tilesCtx),this.tilesCtx.translate(s,0);this.tilesCtx.restore()},n.prototype.prepLevel=function(t){this.backdrop=this.randomBackdrop(this.srng),this.bakeBackdrop(this.backdrop),this.camera={},this.camera.pos={x:0,y:0},this.camera.limits={},this.camera.limits.x={min:0,max:9},this.limits.x={},this.limits.x.min=0,this.limits.x.max=this.camera.limits.x.max+this.aspectWidth/this.aspectHeight,this.limits.y={},this.limits.y.min=this.backdrop.panelHeight,this.limits.y.max=1-this.backdrop.panelHeight,this.ceilingY=this.limits.y.min+this.playerSideLength/2,this.groundY=this.limits.y.max-this.playerSideLength/2,this.player=new o["default"](this.backdrop.panelWidth/2,this.groundY,this.playerSideLength,0),this.playerGrounded=!0,this.patrols=[],this.numPatrols=Math.min(3+4*t,32);for(var e=0;e<this.numPatrols;e++){var i=this.playerSideLength*this.srng.randomInRange(.4,Math.min(.3+.1*t,.8)),s=this.srng.randomInRange(3*this.backdrop.panelWidth+i,this.limits.x.max),n=this.limits.y.max-i,a=this.srng.randomInRange(2*this.backdrop.panelWidth+i,this.limits.x.max),r=this.limits.y.max-i,h=this.playerWalkSpeed*this.srng.randomInRange(.2,Math.min(.1+.1*t,.6)),l=new b["default"](s,n,i,{x:a,y:r},{x:s,y:n},h);this.patrols.push(l)}},n.prototype.startGame=function(t){this.srng=new u["default"](t),this.kills=0,this.level=1,this.streak=0,this.highestStreak=0,this.fadeInLoop.timestepper.reset(),this.gameLoop.timestepper.reset(),this.playerCamMinOffset=this.aspectWidth/this.aspectHeight*.45,this.playerCamMaxOffset=this.aspectWidth/this.aspectHeight*.55,this.jumpCycles=0,this.prepLevel(this.level),this.dead=!1,this.fadeInLoop.stopCallback=function(){this.gameLoop.start()}.bind(this),this.fadeInOpacity=1,this.fadeInLoop.start()},n.prototype.drawTiles=function(){this.tileXOffset=this.camera.pos.x*this.tileFactor%this.backdrop.tileLength,this.ctx.save(),this.ctx.translate(-this.tileXOffset*this.c.height,0),this.ctx.drawImage(this.tilesC,0,0,this.tilesC.width,this.tilesC.height,0,this.panelsC.height,this.tilesC.width,this.tilesC.height),this.ctx.restore()},n.prototype.drawPanels=function(){this.panelXOffset=this.camera.pos.x%this.panelGroupWidth,this.ctx.save(),this.ctx.translate(-this.panelXOffset*this.c.height,0),this.ctx.drawImage(this.panelsC,0,0,this.panelsC.width,this.panelsC.height,0,0,this.panelsC.width,this.panelsC.height),this.ctx.translate(0,this.c.height),this.ctx.scale(1,-1),this.ctx.drawImage(this.panelsC,0,0,this.panelsC.width,this.panelsC.height,0,0,this.panelsC.width,this.panelsC.height),this.ctx.restore()},n.prototype.drawBackdrop=function(){this.drawTiles(),this.drawPanels()},n.prototype.drawPlayer=function(){this.ctx.save(),this.ctx.scale(this.c.height,this.c.height),this.ctx.translate(-this.camera.pos.x,-this.camera.pos.y),this.player.draw(this.ctx),this.ctx.restore()},n.prototype.drawPatrols=function(){this.ctx.save(),this.ctx.scale(this.c.height,this.c.height),this.ctx.translate(-this.camera.pos.x,-this.camera.pos.y);for(var t=this.patrols.length,e=0;t>e;e++)this.patrols[e].draw(this.ctx);this.ctx.restore()},n.prototype.gameWork=function(){var t=0;this.kb.keydown[this.keys.RIGHT.ID]===!0&&(t+=1),this.kb.keydown[this.keys.LEFT.ID]===!0&&(t-=1);var e;e=this.kb.keydown[this.keys.MOD.ID]===!0?this.playerRunSpeed:this.playerWalkSpeed;var i=this.playerGrounded?1:this.playerAirFactor;this.player.vel.x+=t*e*i,this.player.vel.x*=this.playerXMoveFactor,this.player.pos.x+=this.player.vel.x,
this.player.pos.x<0&&(this.player.pos.x=0),(this.kb.keydown[this.keys.UP.ID]===!0||this.kb.keydown[this.keys.ACTION.ID]===!0||this.kb.keydown[this.keys.CONFIRM.ID]===!0)&&this.jumpCycles<this.maxJumpCycles&&(this.jumpCycles+=1,this.player.vel.y-=this.jumpRate),this.player.vel.y+=this.fallRate,this.player.pos.y+=this.player.vel.y,this.player.pos.y>=this.groundY?(this.player.pos.y=this.groundY,this.player.vel.y=0,this.jumpCycles=0,this.streak=0,this.playerGrounded=!0):(this.playerGrounded=!1,this.player.pos.y<=this.ceilingY&&(this.player.pos.y=this.ceilingY,this.player.vel.y=0)),this.playerCamDiff=this.player.pos.x-this.camera.pos.x,this.playerCamDiff<this.playerCamMinOffset?this.camera.pos.x=this.player.pos.x-this.playerCamMinOffset:this.playerCamDiff>this.playerCamMaxOffset&&(this.camera.pos.x=this.player.pos.x-this.playerCamMaxOffset),this.camera.pos.x=(0,c["default"])(this.camera.pos.x,this.camera.limits.x.min,this.camera.limits.x.max);for(var s=this.patrols.length,n=0;s>n;n++)this.patrols[n].move();var a=0;if(this.patrols.forEach(function(t){var e=Math.atan2(t.pos.y-this.player.pos.y,t.pos.x-this.player.pos.x),i=this.player.getRadius(e)+t.radius,s=C["default"].distance(this.player.pos,t.pos);if(i>s){var n=Math.atan2(this.player.vel.y,this.player.vel.x);this.player.pos.y<t.pos.y&&n>0&&n<Math.PI?(a+=1,this.kills+=1,this.patrols.splice(this.patrols.indexOf(t),1)):this.dead=!0}}.bind(this)),a>0&&(this.player.vel.y=a*-this.killBounce,this.streak+=a,this.streak>this.highestStreak&&(this.highestStreak=this.streak)),this.nightmareMode){this.ctx.save();var o=(new Date).getTime();this.ctx.translate(this.c.width/2,this.c.height/2),this.ctx.rotate(Math.PI/32*Math.sin(o/1200));var r=.6+.2*Math.cos(o/600);this.ctx.scale(r,r),this.ctx.translate(-this.c.width/2,-this.c.height/2),this.drawBackdrop(),this.drawPlayer(),this.drawPatrols(),this.ctx.restore()}else this.drawBackdrop(),this.drawPlayer(),this.drawPatrols();this.dead?(this.isDyingCallback(),this.die()):this.player.pos.x>this.limits.x.max&&(this.gameLoop.stopCallback=function(){this.level+=1,this.prepLevel(this.level),this.fadeInLoop.stopCallback=function(){this.gameLoop.start()}.bind(this),this.fadeInOpacity=1,this.fadeInLoop.start()}.bind(this),this.gameLoop.stop())},n.prototype.die=function(){this.totalTime=this.fadeInLoop.timestepper.totalTime+this.gameLoop.timestepper.totalTime,this.speed=(this.level-1)/(this.totalTime/1e3/60),this.outCircleRadius=this.c.width,this.playerX=this.player.pos.x-this.camera.pos.x,this.overRedOpacity=0,this.fadeInLoop.looping?(this.fadeInLoop.stopCallback=function(){this.dieLoop.start()}.bind(this),this.fadeInLoop.stop()):(this.gameLoop.stopCallback=function(){this.dieLoop.start()}.bind(this),this.gameLoop.stop())},n.prototype.dieWork=function(){this.outCircleRadius*=this.outCircleFactor+(.99-this.outCircleFactor)*(1-this.outCircleRadius/this.c.width),this.overRedOpacity+=this.overRedOpacityRate,this.overRedOpacity=Math.min(.6,this.overRedOpacity),this.ctx.save(),this.ctx.globalCompositeOperation="hard-light",this.drawBackdrop(),this.drawPlayer(),this.drawPatrols(),this.ctx.fillStyle="rgba(152, 8, 8, "+this.overRedOpacity+")",this.ctx.fillRect(0,0,this.c.width,this.c.height),this.ctx.beginPath(),this.ctx.rect(0,0,this.c.width,this.c.height),this.ctx.arc(this.playerX*this.c.height,this.player.pos.y*this.c.height,this.outCircleRadius,0,2*Math.PI,!0),this.ctx.fillStyle="#000",this.ctx.fill(),this.ctx.closePath(),this.ctx.restore(),this.outCircleRadius<2*this.player.sideLength*this.c.height&&this.dieLoop.stop()},n.prototype.fadeInWork=function(){this.fadeInOpacity*=this.fadeInFactor,this.fadeInOpacity<0&&(this.fadeInOpacity=0),this.gameWork(),this.ctx.save(),this.ctx.fillStyle="rgba(0, 0, 0, "+this.fadeInOpacity+")",this.ctx.fillRect(0,0,this.c.width,this.c.height),this.ctx.restore(),this.fadeInOpacity<.05&&this.fadeInLoop.stop()},n.prototype.drawFinalFrame=function(){this.ctx.save(),this.ctx.scale(this.c.width,this.c.height),this.ctx.drawImage(this.finalFrame,0,0,1,1),this.ctx.restore()},n.prototype.handleResize=function(){void 0!=this.backdrop&&this.bakeBackdrop(this.backdrop)},e["default"]=n},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function n(t){"string"==typeof t?this.seed=t:this.seed="",this.currentHash=o["default"].hash(this.seed),this.currentHashLeft=this.currentHash,this.numHashes=1}Object.defineProperty(e,"__esModule",{value:!0});var a=i(5),o=s(a);n.HASH_LENGTH=32,n.prototype.reset=function(){this.currentHash=o["default"].hash(this.seed),this.currentHashLeft=this.currentHash,this.numHashes=1},n.prototype.rehash=function(){this.currentHash=o["default"].hash(this.currentHash),this.currentHashLeft=this.currentHash,this.numHashes+=1},n.prototype.getHash=function(t){if("number"!=typeof t)throw"Non-NumberLength";if(0>t)throw"NegativeLength";if(0===t)return"";var e;if(this.currentHashLeft.length>=t)e=this.currentHashLeft.substr(0,t),this.currentHashLeft=this.currentHashLeft.substr(t,this.currentHashLeft.length);else{e=this.currentHashLeft;var i=t-e.length,s=Math.floor(i/n.HASH_LENGTH);if(s>0){for(var a=0;s>a;a++)this.rehash(),e+=this.currentHash;i-=s*n.HASH_LENGTH,i>0?(this.rehash(),e+=this.currentHashLeft.substr(0,i),this.currentHashLeft=this.currentHashLeft.substr(i,this.currentHashLeft.length)):this.currentHashLeft=""}else this.rehash(),e+=this.currentHashLeft.substr(0,i),this.currentHashLeft=this.currentHashLeft.substr(i,this.currentHashLeft.length)}return e},e["default"]=n},function(t,e){"use strict";function i(t){this.target=t,this.keydown={},this.listening=!1,this.keydownEvent=this.handleKeydown.bind(this),this.keyupEvent=this.handleKeyup.bind(this)}Object.defineProperty(e,"__esModule",{value:!0}),i.prototype.clear=function(){this.keydown={}},i.getKeyIdentifier=function(t){return t.keyCode},i.prototype.handleKeydown=function(t){var e=i.getKeyIdentifier(t);this.keydown[e]=!0},i.prototype.handleKeyup=function(t){var e=i.getKeyIdentifier(t);this.keydown[e]=!1},i.prototype.startListen=function(){this.listening=!0,this.target.addEventListener("keydown",this.keydownEvent),this.target.addEventListener("keyup",this.keyupEvent)},i.prototype.stopListen=function(){this.target.removeEventListener("keydown",this.keydownEvent),this.target.removeEventListener("keyup",this.keyupEvent),this.listening=!1},e["default"]=i},function(t,e){"use strict";function i(t,e,i,s){this.target=t,this.eventType=e,this.work=i,this.active=!1,void 0==s?this.newBind=!1:(this.thisObject=s,this.newBind=!0),this.newBind&&(this.workBound=i.bind(this.thisObject))}Object.defineProperty(e,"__esModule",{value:!0}),i.prototype.start=function(){if(this.active)throw{name:"State error",message:"Not going to start listener system--already active"};this.newBind?this.target.addEventListener(this.eventType,this.workBound):this.target.addEventListener(this.eventType,this.work),this.active=!0},i.prototype.stop=function(){if(!this.active)throw{name:"State error",message:"Not going to stop listener system--already inactive"};this.newBind?this.target.removeEventListener(this.eventType,this.workBound):this.target.removeEventListener(this.eventType,this.work),this.active=!1},e["default"]=i},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=function(t,e,i,s){if(0>t||0>e||0===t&&0===e)return{width:0,height:0};if(0===t)return{width:0,height:s};if(0===e)return{width:i,height:0};if(0>=i||0>=s)return{width:0,height:0};var n,a,o=t/e,r=i/s;if(o===r)n=i,a=s;else if(r>o){var h=Math.floor(s/e);n=h*t,a=h*e}else if(o>r){var h=Math.floor(i/t);n=h*t,a=h*e}return{width:n,height:a}}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=function(t,e){return Math.pow(e,t)-1}},function(t,e){"use strict";function i(t,e,i,s,n,a,o){this.name=t,this.element=e,this.showZ=i,this.hideZ=s,this.listenerSystems=n||[],this.listenerSystemsActive=!1,this.showWork=a||function(){},this.hideWork=o||function(){}}Object.defineProperty(e,"__esModule",{value:!0}),i.prototype.show=function(){this.element.style["z-index"]=this.showZ,this.element.style.visibility="visible",this.startListenerSystems(),this.showWork()},i.prototype.hide=function(){this.element.style["z-index"]=this.hideZ,this.element.style.visibility="hidden",this.stopListenerSystems(),this.hideWork()},i.prototype.startListenerSystems=function(){if(this.listenerSystemsActive)throw{name:"State error",message:"Not going to start listener systems--already active"};this.listenerSystems.forEach(function(t){t.start()}),this.listenerSystemsActive=!0},i.prototype.stopListenerSystems=function(){if(!this.listenerSystemsActive)throw{name:"State error",message:"Not going to stop listener systems--already inactive"};this.listenerSystems.forEach(function(t){t.stop()}),this.listenerSystemsActive=!1},e["default"]=i},function(t,e){"use strict";function i(t,e,i,s,n,a){this.pos={x:t,y:e},this.radius=i,this.a=s,this.b=n,this.speed=a,this.done={x:!1,y:!1},this.target=n}Object.defineProperty(e,"__esModule",{value:!0}),i.prototype.move=function(){var t={x:this.target.x-this.pos.x,y:this.target.y-this.pos.y},e={x:Math.abs(t.x),y:Math.abs(t.y)};["x","y"].forEach(function(i){e[i]<this.speed?(this.pos[i]=this.target[i],this.done[i]=!0):this.pos[i]+=this.speed*t[i]/e[i]}.bind(this)),this.done.x&&this.done.y&&(this.target=this.target===this.a?this.b:this.a,this.done.x=!1,this.done.y=!1)},i.render=function(t,e){t.save(),t.beginPath(),t.arc(0,0,e,0,2*Math.PI,!1),t.globalCompositeOperation="difference",t.fillStyle="#fff",t.fill(),t.closePath(),t.restore()},i.prototype.render=function(t){i.render(t,this.radius)},i.prototype.draw=function(t){t.save(),t.translate(this.pos.x,this.pos.y),this.render(t),t.restore()},e["default"]=i},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function n(t,e,i,s){this.pos={},this.pos.x=t||0,this.pos.y=e||0,this.vel={},this.vel.x=0,this.vel.y=0,this.setSideLength(i||.5),this.rotation=s||0,this.setColor(new o["default"](255,255,255,1))}Object.defineProperty(e,"__esModule",{value:!0});var a=i(1),o=s(a);n.prototype.getRadius=function(t){return this.halfSideLength/Math.max(Math.abs(Math.sin(t)),Math.abs(Math.cos(t)))},n.prototype.setSideLength=function(t){this.sideLength=t,this.halfSideLength=t/2},n.prototype.setColor=function(t){this.color=t,this.fillStyle=t.toString()},n.render=function(t,e,i,s){t.save(),t.rotate(s),t.fillStyle=i,t.fillRect(0,0,e,e),t.restore()},n.prototype.render=function(t){n.render(t,this.sideLength,this.fillStyle,this.rotation)},n.prototype.draw=function(t){t.save(),t.translate(this.pos.x-this.halfSideLength,this.pos.y-this.halfSideLength),this.render(t),t.restore()},e["default"]=n},function(t,e){"use strict";function i(t){this.work=t,this.interval=i.DEF_INTERVAL,this.maxIntervals=i.DEF_MAX_INTERVALS,this.time=0,this.totalTime=0}Object.defineProperty(e,"__esModule",{value:!0}),i.DEF_INTERVAL=20,i.DEF_MAX_INTERVALS=10,i.prototype.accumulate=function(t){this.time+=t,this.totalTime+=t},i.prototype["try"]=function(){for(var t=0;this.time>=this.interval&&t<this.maxIntervals;)this.time-=this.interval,t+=1,this.work()},i.prototype.go=function(t){this.accumulate(t),this["try"]()},i.prototype.reset=function(){this.time=0,this.totalTime=0},e["default"]=i},function(t,e){"use strict";function i(){}Object.defineProperty(e,"__esModule",{value:!0}),i["new"]=function(t,e){return{x:t,y:e}},i.clone=function(t){return{x:t.x,y:t.y}},i.distance=function(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},e["default"]=i}]);