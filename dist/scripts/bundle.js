!function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={exports:{},id:i,loaded:!1};return e[i].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}var o=n(7),r=i(o),s=n(12),a=i(s),u=n(14),d=i(u),l=n(11),h=i(l),c=n(1),f=(i(c),n(18)),p=i(f),_=n(15),m=i(_),y=n(8),g=i(y),v=n(3),b=i(v),w=n(2),x=i(w);console.log("main");var A=new r["default"];A.volume=.5,A.c=document.querySelector(".js-app-canvas"),A.ctx=A.c.getContext("2d"),A.appSpace=document.querySelector(".js-app-space"),A.appContainer=document.querySelector(".js-app-container"),A.appCanvas=document.querySelector(".js-app-canvas"),A.game=new a["default"](A.c,A.ctx),A.game.dieLoop.stopCallback=function(){document.querySelector(".js-level").innerHTML=A.game.level,document.querySelector(".js-kills").innerHTML=A.game.kills;var e=A.game.speed.toFixed(2);0==e&&(e=0),document.querySelector(".js-speed").innerHTML=e,document.querySelector(".js-highest-streak").innerHTML=A.game.highestStreak,createImageBitmap(A.game.c).then(function(e){A.game.finalFrame=e,A.menus.end.show()})},A.game.isDyingCallback=function(){A.audioLoopers.silverAndGold.fadeOut()},A.aspectWidth=5,A.aspectHeight=2,A.game.aspectWidth=A.aspectWidth,A.game.aspectHeight=A.aspectHeight,A.kb=new d["default"](window),A.game.kb=A.kb,A.keys=h["default"],A.game.keys=A.keys,A.resizeTasks.push(A.resizeComponents.bind(A)),A.resizeTasks.push(A.game.handleResize.bind(A.game)),A.bindHandleResize(window),A.resizeComponents(),A.game.handleResize(),A.audioLoadSuccesses=0,A.audioLoadFailures=0,A.totalAudioLoopers=2,A.audioLoopers={},A.audioLoopers.silverAndGold=new g["default"]({urls:["audio/AJ_-_08_-_Silver_and_Gold.ogg","audio/AJ_-_08_-_Silver_and_Gold.m4a"],onload:function(){A.audioLoadSuccesses+=1},onloaderror:function(e,t){console.log("audio load error.","ID:",e,"error:",t,"this:",this),A.audioLoadFailures+=1}}),A.audioLoopers.bambooShootsAndLadders=new g["default"]({urls:["audio/Daniela_Salvia_-_04_-_Bamboo_Shoots_and_Ladders.ogg","audio/Daniela_Salvia_-_04_-_Bamboo_Shoots_and_Ladders.m4a"],onload:function(){A.audioLoadSuccesses+=1},onloaderror:function(e,t){console.log("audio load error.","ID:",e,"error:",t,"this:",this),A.audioLoadFailures+=1}}),A.mainTitle=document.querySelector(".js-main-title"),A.mainTitleNonNightmareText="<div>Deep Down Days</div>",A.mainTitleNightmareText='<div>Deep Down Days</div><div class="nightmare-subtitle">Nightmare Mode</div>',A.nightmareSVGPath=document.querySelector(".nightmare").querySelector("path"),A.nonNightmareSVGColor="#000000",A.nightmareSVGColor="#ff3333",A.srng=new x["default"](String((new Date).getTime())),A.globalCompositeOperations=["source-over","source-over","source-over","source-over","source-over","lighter","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exculsion","hue","saturation","color","luminosity"],A.GCOsLastIndex=A.globalCompositeOperations.length-1,A.setNonNightmareTitle=function(){A.mainTitle.innerHTML=A.mainTitleNonNightmareText},A.setNightmareTitle=function(){A.mainTitle.innerHTML=A.mainTitleNightmareText},A.nightmareIntervalFunction=function(){A.ctx.globalCompositeOperation=A.globalCompositeOperations[A.srng.randomInt(0,A.GCOsLastIndex)]},A.nightmareIntervalTime=40,A.setNightmareInterval=function(){A.nightmareInterval=window.setInterval(A.nightmareIntervalFunction,A.nightmareIntervalTime)},A.clearNightmareInterval=function(){void 0!=A.nightmareInterval&&window.clearInterval(A.nightmareInterval)},A.turnOnNightmareMode=function(){A.setNightmareTitle(),A.setNightmareInterval(),A.mainTitle.innerHTML=A.mainTitleNightmareText,A.nightmareSVGPath.style.fill=A.nightmareSVGColor,A.nightmareMode=!0,A.game.nightmareMode=!0},A.turnOffNightmareMode=function(){A.setNonNightmareTitle(),A.clearNightmareInterval(),A.mainTitle.innerHTML=A.mainTitleNonNightmareText,A.nightmareSVGPath.style.fill=A.nonNightmareSVGColor,A.ctx.globalCompositeOperation="source-over",A.nightmareMode=!1,A.game.nightmareMode=!1},A.toggleNightmareMode=function(){A.nightmareMode?A.turnOffNightmareMode():A.turnOnNightmareMode()},A.nightmareMode=!1,A.turnOffNightmareMode(),A.useLoadingColorA=!0,A.loadingColorA="rgb(10, 240, 40)",A.loadingColorB="rgb(10, 40, 240)",A.loadingInfoElement=document.querySelector(".js-loading-info"),A.loadingMenuWork=function(){this.audioLoadFailures>0?(this.loadingInfoElement.style.color="#fff",this.loadingInfoElement.innerHTML='<div>Failed to load audio.</div>\n\t\t<div>Refresh or try another browser.</div>\n\t\t<br>\n\t\t<div><a href="https://github.com/Costava/deep-down-days" target="_blank">View source on GitHub</a>.</div>',A.loadingMenuLoop.stopCallback=function(){console.log("Failed to load audio. Loading loop stopped.")},A.loadingMenuLoop.stop()):this.audioLoadSuccesses===this.totalAudioLoopers?(A.loadingMenuLoop.stopCallback=function(){A.menus.loading.hide(),A.menus.main.show()},A.loadingMenuLoop.stop()):(this.useLoadingColorA?this.loadingInfoElement.style.color=this.loadingColorA:this.loadingInfoElement.style.color=this.loadingColorB,this.useLoadingColorA=!this.useLoadingColorA)},A.loadingMenuLoop=new b["default"](A.loadingMenuWork.bind(A)),A.mainMenuSpeed=.025,A.tileFactor=.5,A.mainMenuTitle=document.querySelector(".js-main-title"),A.mainMenuWork=function(){if(A.mainMenuNewTime=(new Date).getTime(),A.mainMenuTime+=A.mainMenuNewTime-A.mainMenuOldTime,A.mainMenuOldTime=A.mainMenuNewTime,A.mainMenuTime>3600){var e=A.game.srng.randomInt(50,255),t=A.game.srng.randomInt(50,255),n=A.game.srng.randomInt(50,255);A.mainMenuTitle.style.color="rgb("+e+", "+t+", "+n+")",A.game.backdrop=A.game.randomBackdrop(A.game.srng),A.game.bakeBackdrop(A.game.backdrop),A.mainMenuTime=0}A.panelGroupOffset+=A.mainMenuSpeed,A.panelGroupOffset%=A.game.panelGroupWidth,A.tileOffset+=A.mainMenuSpeed*A.tileFactor,A.tileOffset%=A.game.backdrop.tileLength,A.game.ctx.save(),A.game.ctx.translate(-A.panelGroupOffset*A.game.c.height,0),A.game.ctx.drawImage(A.game.panelsC,0,0,A.game.panelsC.width,A.game.panelsC.height,0,0,A.game.panelsC.width,A.game.panelsC.height),A.game.ctx.translate(0,A.game.c.height),A.game.ctx.scale(1,-1),A.game.ctx.drawImage(A.game.panelsC,0,0,A.game.panelsC.width,A.game.panelsC.height,0,0,A.game.panelsC.width,A.game.panelsC.height),A.game.ctx.restore(),A.game.ctx.save(),A.game.ctx.translate(-A.tileOffset*A.game.c.height,0),A.game.ctx.drawImage(A.game.tilesC,0,0,A.game.tilesC.width,A.game.tilesC.height,0,A.game.panelsC.height,A.game.tilesC.width,A.game.tilesC.height),A.game.ctx.restore()},A.mainMenuLoop=new b["default"](A.mainMenuWork.bind(A)),A.menus={},A.menus.loading=new p["default"]("loading",document.querySelector(".js-loading-menu"),1e3,(-1e3),[],function(){A.loadingMenuLoop.start()},function(){}),A.menus.main=new p["default"]("main",document.querySelector(".js-main-menu"),1e3,(-1e3),[new m["default"](document.querySelector(".js-main-play"),"click",function(){A.mainMenuLoop.stopCallback=function(){A.startInstructions(),A.audioLoopers.silverAndGold.fadeIn(),A.game.startGame(String((new Date).getTime()))},A.menus.main.hide()}),new m["default"](document.querySelector(".js-main-about"),"click",function(){A.menus.about.show()}),new m["default"](document.querySelector(".js-nightmare-wrapper"),"click",function(){A.toggleNightmareMode()}),new m["default"](document.body,"keydown",function(e){d["default"].getKeyIdentifier(e)==A.keys.LEFT.ID?(A.mainMenuLoop.stopCallback=function(){A.startInstructions(),A.audioLoopers.silverAndGold.fadeIn(),A.game.startGame(String((new Date).getTime()))},A.menus.main.hide()):d["default"].getKeyIdentifier(e)==A.keys.RIGHT.ID?A.menus.about.show():d["default"].getKeyIdentifier(e)==A.keys.DOWN.ID&&A.toggleNightmareMode()})],function(){A.mainMenuOldTime=(new Date).getTime(),A.mainMenuTime=0,A.game.srng=new x["default"](String((new Date).getTime())),A.game.backdrop=A.game.randomBackdrop(A.game.srng),A.game.bakeBackdrop(A.game.backdrop),A.panelGroupOffset=0,A.tileOffset=0,A.audioLoopers.bambooShootsAndLadders.fadeIn(),A.mainMenuLoop.start()},function(){A.audioLoopers.bambooShootsAndLadders.fadeOut(),A.mainMenuLoop.stop()}),A.menus.about=new p["default"]("about",document.querySelector(".js-about-menu"),2e3,(-1e3),[new m["default"](document.querySelector(".js-about-return"),"click",function(){A.menus.about.hide()}),new m["default"](document.body,"keydown",function(e){d["default"].getKeyIdentifier(e)!=A.keys.CANCEL.ID&&d["default"].getKeyIdentifier(e)!=A.keys.DOWN.ID||A.menus.about.hide()})],function(){A.menus.main.stopListenerSystems()},function(){A.menus.main.startListenerSystems()}),A.menus.end=new p["default"]("end",document.querySelector(".js-end-menu"),2e3,(-1e3),[new m["default"](document.querySelector(".js-end-again"),"click",function(){A.menus.end.hide(),A.startInstructions(),A.audioLoopers.silverAndGold.fadeIn(),A.game.startGame(String((new Date).getTime()))}),new m["default"](document.querySelector(".js-end-main"),"click",function(){A.menus.end.hide(),A.menus.main.show()}),new m["default"](document.body,"keydown",function(e){d["default"].getKeyIdentifier(e)==A.keys.LEFT.ID?(A.menus.end.hide(),A.startInstructions(),A.audioLoopers.silverAndGold.fadeIn(),A.game.startGame(String((new Date).getTime()))):d["default"].getKeyIdentifier(e)!=A.keys.CANCEL.ID&&d["default"].getKeyIdentifier(e)!=A.keys.RIGHT.ID||(A.menus.end.hide(),A.menus.main.show())})],function(){window.addEventListener("resize",A.game.drawFinalFrameBound)},function(){window.removeEventListener("resize",A.game.drawFinalFrameBound)}),A.instructions=document.querySelector(".js-instructions"),A.showInstructions=function(){this.instructions.style["margin-top"]="0"},A.hideInstructions=function(){this.instructions.style["margin-top"]="-100%"},A.startInstructions=function(){this.showInstructions(),void 0!=this.instructionsHideTimeout&&clearTimeout(this.instructionsHideTimeout),this.instructionsHideTimeout=setTimeout(function(){this.hideInstructions()}.bind(this),4e3)},A.kb.startListen(),A.menus.loading.show()},function(e,t){"use strict";function n(e,t,n,i){this.r=e,this.g=t,this.b=n,this.a=i}Object.defineProperty(t,"__esModule",{value:!0}),n.random=function(e,t){var i,o=e(0,255),r=e(0,255),s=e(0,255);return i="number"==typeof t?t:1,new n(o,r,s,i)},n.prototype.toString=function(e){return e===!0?"rgb("+this.r+", "+this.g+", "+this.b+")":"rgba("+this.r+", "+this.g+", "+this.b+", "+this.a+")"},n.prototype.inverse=function(e){return e===!0?new n(255-this.r,255-this.g,255-this.b,1-this.a):new n(255-this.r,255-this.g,255-this.b,this.a)},n.prototype.clamp=function(){var e=this.clone();return["r","g","b"].forEach(function(t){e[t]=Math.max(Math.min(e[t],255),0)}),this.a=Math.max(Math.min(this.a,1),0),e},n.prototype.operate=function(e,t){var n=this.clone();return["r","g","b"].forEach(function(t){n[t]=e(n[t])}),t===!0&&(n.a=e(n.a)),n},n.prototype.clone=function(){return new n(this.r,this.g,this.b,this.a)},t["default"]=n},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){this.hashStream=new s["default"](e),void 0===t?this.setResolution(o.DEFAULT_NOMINAL_RESOLUTION):this.setResolution(t)}Object.defineProperty(t,"__esModule",{value:!0});var r=n(13),s=i(r),a=n(17),u=i(a);o.DEFAULT_NOMINAL_RESOLUTION=1e-9,o.prototype.reset=function(){this.hashStream.reset()},o.prototype.setResolution=function(e){if("number"!=typeof e)throw"Non-NumberResolution";if(e<=0)throw"NonpositiveResolution";this.nominalResolution=e;for(var t=1;1/(0,u["default"])(t,16)>this.nominalResolution;)t+=1;this.pullLength=t,this.pullMaxValue=(0,u["default"])(this.pullLength,16),this.actualResolution=1/(0,u["default"])(this.pullLength,16)},o.prototype.random=function(){var e=this.hashStream.getHash(this.pullLength),t=parseInt(e,16);return t/this.pullMaxValue},o.prototype.randomInt=function(e,t){var n=t-e;return Math.round(this.random()*n)+e},o.prototype.randomInRange=function(e,t){var n=t-e;return this.random()*n+e},t["default"]=o},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e){this.work=e,this.looping=!1,this.stopped=!0,this.stopCallback=function(){},this.timestepper=new s["default"](e),this.loopCallBound=this.loopCall.bind(this)}Object.defineProperty(t,"__esModule",{value:!0});var r=n(21),s=i(r);o.prototype.loopCall=function(){this.newTime=(new Date).getTime(),this.dt=this.newTime-this.oldTime,this.timestepper.go(this.dt),this.oldTime=this.newTime,this.looping?window.requestAnimationFrame(this.loopCallBound):(this.stopped=!0,this.stopCallback())},o.prototype.start=function(){this.oldTime=(new Date).getTime(),this.looping=!0,this.stopped=!1,this.loopCallBound()},o.prototype.stop=function(){this.looping=!1},t["default"]=o},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(){this.colors=[],this.dims=[],this.aSideDominant=!0,this.bSideDominant=!0,this.rects=[]}Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),s=(i(r),n(1)),a=i(s);o.COLORS_LENGTH=6,o.DIMS_LENGTH=4,o.random=function(e){for(var t=new o,n=0;n<o.COLORS_LENGTH;n++){var i=a["default"].random(e.randomInt.bind(e),1);t.colors.push(i)}for(var n=0;n<o.DIMS_LENGTH;n++)t.dims.push(e.random());return t.aSideDominant=e.random()<.5,t.bSideDominant=e.random()<.5,t.generateRects(),t},o.prototype.generateRects=function(){this.rects=[],this.rects.push({x:0,y:0,width:1,height:1,color:this.colors[0]}),this.rects.push({x:0,y:0,width:.5,height:.5,color:this.colors[1]}),this.rects.push({x:.5,y:.5,width:.5,height:.5,color:this.colors[1]}),[0,.5].forEach(function(e){var t={x:e,y:e,width:.5*this.dims[0],height:.5,color:this.colors[2]},n={x:e,y:e,width:.5,height:.5*this.dims[1],color:this.colors[3]};this.aSideDominant?(this.rects.push(n),this.rects.push(t)):(this.rects.push(t),this.rects.push(n))}.bind(this)),[0,.5].forEach(function(e){var t={x:e,y:.5-e,width:.5*this.dims[2],height:.5,color:this.colors[4]},n={x:e,y:.5-e,width:.5,height:.5*this.dims[3],color:this.colors[5]};this.bSideDominant?(this.rects.push(n),this.rects.push(t)):(this.rects.push(t),this.rects.push(n))}.bind(this))},o.prototype.render=function(e){this.rects.forEach(function(t){e.save(),e.translate(t.x,t.y),e.beginPath(),e.rect(0,0,t.width,t.height),e.fillStyle=t.color.toString(),e.fill(),e.closePath(),e.restore()})},t["default"]=o},function(e,t,n){var i,o;(function(n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};/*!
	 *  howler.js v2.0.0
	 *  howlerjs.com
	 *
	 *  (c) 2013-2016, James Simpson of GoldFire Studios
	 *  goldfirestudios.com
	 *
	 *  MIT License
	 */
!function(){var r=function(){this.init()};r.prototype={init:function(){var e=this||s;return e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.mobileAutoEnable=!0,e._setup(),e},volume:function(e){var t=this||s;if(e=parseFloat(e),t.ctx||p(),"undefined"!=typeof e&&e>=0&&e<=1){if(t._volume=e,t._muted)return t;t.usingWebAudio&&(t.masterGain.gain.value=e);for(var n=0;n<t._howls.length;n++)if(!t._howls[n]._webAudio)for(var i=t._howls[n]._getSoundIds(),o=0;o<i.length;o++){var r=t._howls[n]._soundById(i[o]);r&&r._node&&(r._node.volume=r._volume*e)}return t}return t._volume},mute:function(e){var t=this||s;t.ctx||p(),t._muted=e,t.usingWebAudio&&(t.masterGain.gain.value=e?0:t._volume);for(var n=0;n<t._howls.length;n++)if(!t._howls[n]._webAudio)for(var i=t._howls[n]._getSoundIds(),o=0;o<i.length;o++){var r=t._howls[n]._soundById(i[o]);r&&r._node&&(r._node.muted=!!e||r._muted)}return t},unload:function(){for(var e=this||s,t=e._howls.length-1;t>=0;t--)e._howls[t].unload();return e.usingWebAudio&&"undefined"!=typeof e.ctx.close&&(e.ctx.close(),e.ctx=null,p()),e},codecs:function(e){return(this||s)._codecs[e]},_setup:function(){var e=this||s;return e.state=e.ctx?e.ctx.state||"running":"running",e._autoSuspend(),e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||s,t="undefined"!=typeof Audio?new Audio:null;if(!t||"function"!=typeof t.canPlayType)return e;var n=t.canPlayType("audio/mpeg;").replace(/^no$/,""),i=e._navigator&&e._navigator.userAgent.match(/OPR\/([0-6].)/g),o=i&&parseInt(i[0].split("/")[1],10)<33;return e._codecs={mp3:!(o||!n&&!t.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!n,opus:!!t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!t.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!t.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!t.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(t.canPlayType("audio/x-mp4;")||t.canPlayType("audio/mp4;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!t.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,"")},e},_enableMobileAudio:function(){var e=this||s,t=/iPhone|iPad|iPod|Android|BlackBerry|BB10|Silk|Mobi/i.test(e._navigator&&e._navigator.userAgent),n=!!("ontouchend"in window||e._navigator&&e._navigator.maxTouchPoints>0||e._navigator&&e._navigator.msMaxTouchPoints>0);if(!e._mobileEnabled&&e.ctx&&(t||n)){e._mobileEnabled=!1,e._mobileUnloaded||44100===e.ctx.sampleRate||(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var i=function o(){var t=e.ctx.createBufferSource();t.buffer=e._scratchBuffer,t.connect(e.ctx.destination),"undefined"==typeof t.start?t.noteOn(0):t.start(0),t.onended=function(){t.disconnect(0),e._mobileEnabled=!0,e.mobileAutoEnable=!1,document.removeEventListener("touchend",o,!0)}};return document.addEventListener("touchend",i,!0),e}},_autoSuspend:function(){var e=this;if(e.autoSuspend&&e.ctx&&"undefined"!=typeof e.ctx.suspend&&s.usingWebAudio){for(var t=0;t<e._howls.length;t++)if(e._howls[t]._webAudio)for(var n=0;n<e._howls[t]._sounds.length;n++)if(!e._howls[t]._sounds[n]._paused)return e;return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout(function(){e.autoSuspend&&(e._suspendTimer=null,e.state="suspending",e.ctx.suspend().then(function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())}))},3e4),e}},_autoResume:function(){var e=this;if(e.ctx&&"undefined"!=typeof e.ctx.resume&&s.usingWebAudio)return"running"===e.state&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):"suspended"===e.state?(e.state="resuming",e.ctx.resume().then(function(){e.state="running"}),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):"suspending"===e.state&&(e._resumeAfterSuspend=!0),e}};var s=new r,a=function(e){var t=this;return e.src&&0!==e.src.length?void t.init(e):void console.error("An array of source files must be passed with any new Howl.")};a.prototype={init:function(e){var t=this;return s.ctx||p(),t._autoplay=e.autoplay||!1,t._format="string"!=typeof e.format?e.format:[e.format],t._html5=e.html5||!1,t._muted=e.mute||!1,t._loop=e.loop||!1,t._pool=e.pool||5,t._preload="boolean"!=typeof e.preload||e.preload,t._rate=e.rate||1,t._sprite=e.sprite||{},t._src="string"!=typeof e.src?e.src:[e.src],t._volume=void 0!==e.volume?e.volume:1,t._duration=0,t._state="unloaded",t._sounds=[],t._endTimers={},t._queue=[],t._onend=e.onend?[{fn:e.onend}]:[],t._onfade=e.onfade?[{fn:e.onfade}]:[],t._onload=e.onload?[{fn:e.onload}]:[],t._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],t._onpause=e.onpause?[{fn:e.onpause}]:[],t._onplay=e.onplay?[{fn:e.onplay}]:[],t._onstop=e.onstop?[{fn:e.onstop}]:[],t._onmute=e.onmute?[{fn:e.onmute}]:[],t._onvolume=e.onvolume?[{fn:e.onvolume}]:[],t._onrate=e.onrate?[{fn:e.onrate}]:[],t._onseek=e.onseek?[{fn:e.onseek}]:[],t._webAudio=s.usingWebAudio&&!t._html5,"undefined"!=typeof s.ctx&&s.ctx&&s.mobileAutoEnable&&s._enableMobileAudio(),s._howls.push(t),t._preload&&t.load(),t},load:function(){var e=this,t=null;if(s.noAudio)return void e._emit("loaderror",null,"No audio support.");"string"==typeof e._src&&(e._src=[e._src]);for(var n=0;n<e._src.length;n++){var i,o;if(e._format&&e._format[n])i=e._format[n];else{if(o=e._src[n],"string"!=typeof o){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}i=/^data:audio\/([^;,]+);/i.exec(o),i||(i=/\.([^.]+)$/.exec(o.split("?",1)[0])),i&&(i=i[1].toLowerCase())}if(s.codecs(i)){t=e._src[n];break}}return t?(e._src=t,e._state="loading","https:"===window.location.protocol&&"http:"===t.slice(0,5)&&(e._html5=!0,e._webAudio=!1),new u(e),e._webAudio&&l(e),e):void e._emit("loaderror",null,"No codec support for selected audio sources.")},play:function(e,t){var n=this,i=null;if("number"==typeof e)i=e,e=null;else{if("string"==typeof e&&"loaded"===n._state&&!n._sprite[e])return null;if("undefined"==typeof e){e="__default";for(var o=0,r=0;r<n._sounds.length;r++)n._sounds[r]._paused&&!n._sounds[r]._ended&&(o++,i=n._sounds[r]._id);1===o?e=null:i=null}}var a=i?n._soundById(i):n._inactiveSound();if(!a)return null;if(i&&!e&&(e=a._sprite||"__default"),"loaded"!==n._state&&!n._sprite[e])return n._queue.push({event:"play",action:function(){n.play(n._soundById(a._id)?a._id:void 0)}}),a._id;if(i&&!a._paused)return t||setTimeout(function(){n._emit("play",a._id)},0),a._id;n._webAudio&&s._autoResume();var u=a._seek>0?a._seek:n._sprite[e][0]/1e3,d=(n._sprite[e][0]+n._sprite[e][1])/1e3-u,l=1e3*d/Math.abs(a._rate);a._paused=!1,a._ended=!1,a._sprite=e,a._seek=u,a._start=n._sprite[e][0]/1e3,a._stop=(n._sprite[e][0]+n._sprite[e][1])/1e3,a._loop=!(!a._loop&&!n._sprite[e][2]);var h=a._node;if(n._webAudio){var c=function(){n._refreshBuffer(a);var e=a._muted||n._muted?0:a._volume;h.gain.setValueAtTime(e,s.ctx.currentTime),a._playStart=s.ctx.currentTime,"undefined"==typeof h.bufferSource.start?a._loop?h.bufferSource.noteGrainOn(0,u,86400):h.bufferSource.noteGrainOn(0,u,d):a._loop?h.bufferSource.start(0,u,86400):h.bufferSource.start(0,u,d),l!==1/0&&(n._endTimers[a._id]=setTimeout(n._ended.bind(n,a),l)),t||setTimeout(function(){n._emit("play",a._id)},0)};"loaded"===n._state?c():(n.once("load",c,a._id),n._clearTimer(a._id))}else{var f=function(){h.currentTime=u,h.muted=a._muted||n._muted||s._muted||h.muted,h.volume=a._volume*s.volume(),h.playbackRate=a._rate,setTimeout(function(){h.play(),l!==1/0&&(n._endTimers[a._id]=setTimeout(n._ended.bind(n,a),l)),t||n._emit("play",a._id)},0)},p="loaded"===n._state&&(window&&window.ejecta||!h.readyState&&s._navigator.isCocoonJS);if(4===h.readyState||p)f();else{var _=function m(){f(),h.removeEventListener(s._canPlayEvent,m,!1)};h.addEventListener(s._canPlayEvent,_,!1),n._clearTimer(a._id)}}return a._id},pause:function(e){var t=this;if("loaded"!==t._state)return t._queue.push({event:"pause",action:function(){t.pause(e)}}),t;for(var n=t._getSoundIds(e),i=0;i<n.length;i++){t._clearTimer(n[i]);var o=t._soundById(n[i]);if(o&&!o._paused){if(o._seek=t.seek(n[i]),o._rateSeek=0,o._paused=!0,t._stopFade(n[i]),o._node)if(t._webAudio){if(!o._node.bufferSource)return t;"undefined"==typeof o._node.bufferSource.stop?o._node.bufferSource.noteOff(0):o._node.bufferSource.stop(0),t._cleanBuffer(o._node)}else isNaN(o._node.duration)&&o._node.duration!==1/0||o._node.pause();arguments[1]||t._emit("pause",o._id)}}return t},stop:function(e,t){var n=this;if("loaded"!==n._state)return n._queue.push({event:"stop",action:function(){n.stop(e)}}),n;for(var i=n._getSoundIds(e),o=0;o<i.length;o++){n._clearTimer(i[o]);var r=n._soundById(i[o]);if(r&&!r._paused&&(r._seek=r._start||0,r._rateSeek=0,r._paused=!0,r._ended=!0,n._stopFade(i[o]),r._node))if(n._webAudio){if(!r._node.bufferSource)return n;"undefined"==typeof r._node.bufferSource.stop?r._node.bufferSource.noteOff(0):r._node.bufferSource.stop(0),n._cleanBuffer(r._node)}else isNaN(r._node.duration)&&r._node.duration!==1/0||(r._node.currentTime=r._start||0,r._node.pause());r&&!t&&n._emit("stop",r._id)}return n},mute:function(e,t){var n=this;if("loaded"!==n._state)return n._queue.push({event:"mute",action:function(){n.mute(e,t)}}),n;if("undefined"==typeof t){if("boolean"!=typeof e)return n._muted;n._muted=e}for(var i=n._getSoundIds(t),o=0;o<i.length;o++){var r=n._soundById(i[o]);r&&(r._muted=e,n._webAudio&&r._node?r._node.gain.setValueAtTime(e?0:r._volume,s.ctx.currentTime):r._node&&(r._node.muted=!!s._muted||e),n._emit("mute",r._id))}return n},volume:function(){var e,t,n=this,i=arguments;if(0===i.length)return n._volume;if(1===i.length){var o=n._getSoundIds(),r=o.indexOf(i[0]);r>=0?t=parseInt(i[0],10):e=parseFloat(i[0])}else i.length>=2&&(e=parseFloat(i[0]),t=parseInt(i[1],10));var a;if(!("undefined"!=typeof e&&e>=0&&e<=1))return a=t?n._soundById(t):n._sounds[0],a?a._volume:0;if("loaded"!==n._state)return n._queue.push({event:"volume",action:function(){n.volume.apply(n,i)}}),n;"undefined"==typeof t&&(n._volume=e),t=n._getSoundIds(t);for(var u=0;u<t.length;u++)a=n._soundById(t[u]),a&&(a._volume=e,i[2]||n._stopFade(t[u]),n._webAudio&&a._node&&!a._muted?a._node.gain.setValueAtTime(e,s.ctx.currentTime):a._node&&!a._muted&&(a._node.volume=e*s.volume()),n._emit("volume",a._id));return n},fade:function(e,t,n,i){var o=this,r=Math.abs(e-t),a=e>t?"out":"in",u=r/.01,d=n/u;if("loaded"!==o._state)return o._queue.push({event:"fade",action:function(){o.fade(e,t,n,i)}}),o;o.volume(e,i);for(var l=o._getSoundIds(i),h=0;h<l.length;h++){var c=o._soundById(l[h]);if(c){if(i||o._stopFade(l[h]),o._webAudio&&!c._muted){var f=s.ctx.currentTime,p=f+n/1e3;c._volume=e,c._node.gain.setValueAtTime(e,f),c._node.gain.linearRampToValueAtTime(t,p)}var _=e;c._interval=setInterval(function(e,n){_+="in"===a?.01:-.01,_=Math.max(0,_),_=Math.min(1,_),_=Math.round(100*_)/100,o._webAudio?("undefined"==typeof i&&(o._volume=_),n._volume=_):o.volume(_,e,!0),_===t&&(clearInterval(n._interval),n._interval=null,o.volume(_,e),o._emit("fade",e))}.bind(o,l[h],c),d)}}return o},_stopFade:function(e){var t=this,n=t._soundById(e);return n&&n._interval&&(t._webAudio&&n._node.gain.cancelScheduledValues(s.ctx.currentTime),clearInterval(n._interval),n._interval=null,t._emit("fade",e)),t},loop:function _(){var _,e,t,n=this,i=arguments;if(0===i.length)return n._loop;if(1===i.length){if("boolean"!=typeof i[0])return t=n._soundById(parseInt(i[0],10)),!!t&&t._loop;_=i[0],n._loop=_}else 2===i.length&&(_=i[0],e=parseInt(i[1],10));for(var o=n._getSoundIds(e),r=0;r<o.length;r++)t=n._soundById(o[r]),t&&(t._loop=_,n._webAudio&&t._node&&t._node.bufferSource&&(t._node.bufferSource.loop=_));return n},rate:function m(){var m,e,t=this,n=arguments;if(0===n.length)e=t._sounds[0]._id;else if(1===n.length){var i=t._getSoundIds(),o=i.indexOf(n[0]);o>=0?e=parseInt(n[0],10):m=parseFloat(n[0])}else 2===n.length&&(m=parseFloat(n[0]),e=parseInt(n[1],10));var r;if("number"!=typeof m)return r=t._soundById(e),r?r._rate:t._rate;if("loaded"!==t._state)return t._queue.push({event:"rate",action:function(){t.rate.apply(t,n)}}),t;"undefined"==typeof e&&(t._rate=m),e=t._getSoundIds(e);for(var a=0;a<e.length;a++)if(r=t._soundById(e[a])){r._rateSeek=t.seek(e[a]),r._playStart=t._webAudio?s.ctx.currentTime:r._playStart,r._rate=m,t._webAudio&&r._node&&r._node.bufferSource?r._node.bufferSource.playbackRate.value=m:r._node&&(r._node.playbackRate=m);var u=t.seek(e[a]),d=(t._sprite[r._sprite][0]+t._sprite[r._sprite][1])/1e3-u,l=1e3*d/Math.abs(r._rate);!t._endTimers[e[a]]&&r._paused||(t._clearTimer(e[a]),t._endTimers[e[a]]=setTimeout(t._ended.bind(t,r),l)),t._emit("rate",r._id)}return t},seek:function y(){var y,e,t=this,n=arguments;if(0===n.length)e=t._sounds[0]._id;else if(1===n.length){var i=t._getSoundIds(),o=i.indexOf(n[0]);o>=0?e=parseInt(n[0],10):(e=t._sounds[0]._id,y=parseFloat(n[0]))}else 2===n.length&&(y=parseFloat(n[0]),e=parseInt(n[1],10));if("undefined"==typeof e)return t;if("loaded"!==t._state)return t._queue.push({event:"seek",action:function(){t.seek.apply(t,n)}}),t;var r=t._soundById(e);if(r){if(!("number"==typeof y&&y>=0)){if(t._webAudio){var a=t.playing(e)?s.ctx.currentTime-r._playStart:0,u=r._rateSeek?r._rateSeek-r._seek:0;return r._seek+(u+a*Math.abs(r._rate))}return r._node.currentTime}var d=t.playing(e);d&&t.pause(e,!0),r._seek=y,r._ended=!1,t._clearTimer(e),d&&t.play(e,!0),!t._webAudio&&r._node&&(r._node.currentTime=y),t._emit("seek",e)}return t},playing:function(e){var t=this;if("number"==typeof e){var n=t._soundById(e);return!!n&&!n._paused}for(var i=0;i<t._sounds.length;i++)if(!t._sounds[i]._paused)return!0;return!1},duration:function g(e){var t=this,g=t._duration,n=t._soundById(e);return n&&(g=t._sprite[n._sprite][1]/1e3),g},state:function(){return this._state},unload:function(){for(var e=this,t=e._sounds,n=0;n<t.length;n++){t[n]._paused||(e.stop(t[n]._id),e._emit("end",t[n]._id)),e._webAudio||(t[n]._node.src="data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQAAAAA=",t[n]._node.removeEventListener("error",t[n]._errorFn,!1),t[n]._node.removeEventListener(s._canPlayEvent,t[n]._loadFn,!1)),delete t[n]._node,e._clearTimer(t[n]._id);var i=s._howls.indexOf(e);i>=0&&s._howls.splice(i,1)}var o=!0;for(n=0;n<s._howls.length;n++)if(s._howls[n]._src===e._src){o=!1;break}return d&&o&&delete d[e._src],e._state="unloaded",e._sounds=[],e=null,null},on:function(e,t,n,i){var o=this,r=o["_on"+e];return"function"==typeof t&&r.push(i?{id:n,fn:t,once:i}:{id:n,fn:t}),o},off:function(e,t,n){var i=this,o=i["_on"+e],r=0;if(t){for(r=0;r<o.length;r++)if(t===o[r].fn&&n===o[r].id){o.splice(r,1);break}}else if(e)i["_on"+e]=[];else{var s=Object.keys(i);for(r=0;r<s.length;r++)0===s[r].indexOf("_on")&&Array.isArray(i[s[r]])&&(i[s[r]]=[])}return i},once:function(e,t,n){var i=this;return i.on(e,t,n,1),i},_emit:function(e,t,n){for(var i=this,o=i["_on"+e],r=o.length-1;r>=0;r--)o[r].id&&o[r].id!==t&&"load"!==e||(setTimeout(function(e){e.call(this,t,n)}.bind(i,o[r].fn),0),o[r].once&&i.off(e,o[r].fn,o[r].id));return i},_loadQueue:function(){var e=this;if(e._queue.length>0){var t=e._queue[0];e.once(t.event,function(){e._queue.shift(),e._loadQueue()}),t.action()}return e},_ended:function(e){var t=this,n=e._sprite,i=!(!e._loop&&!t._sprite[n][2]);if(t._emit("end",e._id),!t._webAudio&&i&&t.stop(e._id,!0).play(e._id),t._webAudio&&i){t._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=s.ctx.currentTime;var o=1e3*(e._stop-e._start)/Math.abs(e._rate);t._endTimers[e._id]=setTimeout(t._ended.bind(t,e),o)}return t._webAudio&&!i&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,t._clearTimer(e._id),t._cleanBuffer(e._node),s._autoSuspend()),t._webAudio||i||t.stop(e._id),t},_clearTimer:function(e){var t=this;return t._endTimers[e]&&(clearTimeout(t._endTimers[e]),delete t._endTimers[e]),t},_soundById:function(e){for(var t=this,n=0;n<t._sounds.length;n++)if(e===t._sounds[n]._id)return t._sounds[n];return null},_inactiveSound:function(){var e=this;e._drain();for(var t=0;t<e._sounds.length;t++)if(e._sounds[t]._ended)return e._sounds[t].reset();return new u(e)},_drain:function(){var e=this,t=e._pool,n=0,i=0;if(!(e._sounds.length<t)){for(i=0;i<e._sounds.length;i++)e._sounds[i]._ended&&n++;for(i=e._sounds.length-1;i>=0;i--){if(n<=t)return;e._sounds[i]._ended&&(e._webAudio&&e._sounds[i]._node&&e._sounds[i]._node.disconnect(0),e._sounds.splice(i,1),n--)}}},_getSoundIds:function(e){var t=this;if("undefined"==typeof e){for(var n=[],i=0;i<t._sounds.length;i++)n.push(t._sounds[i]._id);return n}return[e]},_refreshBuffer:function(e){var t=this;return e._node.bufferSource=s.ctx.createBufferSource(),e._node.bufferSource.buffer=d[t._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop),e._node.bufferSource.playbackRate.value=e._rate,t},_cleanBuffer:function(e){var t=this;if(t._scratchBuffer){e.bufferSource.onended=null,e.bufferSource.disconnect(0);try{e.bufferSource.buffer=t._scratchBuffer}catch(n){}}return e.bufferSource=null,t}};var u=function(e){this._parent=e,this.init()};u.prototype={init:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._muted=t._muted,e._rate=t._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=Math.round(Date.now()*Math.random()),t._sounds.push(e),e.create(),e},create:function(){var e=this,t=e._parent,n=s._muted||e._muted||e._parent._muted?0:e._volume;return t._webAudio?(e._node="undefined"==typeof s.ctx.createGain?s.ctx.createGainNode():s.ctx.createGain(),e._node.gain.setValueAtTime(n,s.ctx.currentTime),e._node.paused=!0,e._node.connect(s.masterGain)):(e._node=new Audio,e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(s._canPlayEvent,e._loadFn,!1),e._node.src=t._src,e._node.preload="auto",e._node.volume=n*s.volume(),e._node.load()),e},reset:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._muted=t._muted,e._rate=t._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=Math.round(Date.now()*Math.random()),e},_errorListener:function(){var e=this;e._node.error&&4===e._node.error.code&&(s.noAudio=!0),e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorListener,!1)},_loadListener:function(){var e=this,t=e._parent;t._duration=Math.ceil(10*e._node.duration)/10,0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue()),t._autoplay&&t.play(),e._node.removeEventListener(s._canPlayEvent,e._loadFn,!1)}};var d={},l=function(e){var t=e._src;if(d[t])return e._duration=d[t].duration,void f(e);if(/^data:[^;]+;base64,/.test(t)){for(var n=atob(t.split(",")[1]),i=new Uint8Array(n.length),o=0;o<n.length;++o)i[o]=n.charCodeAt(o);c(i.buffer,e)}else{var r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType="arraybuffer",r.onload=function(){var t=(r.status+"")[0];return"0"!==t&&"2"!==t&&"3"!==t?void e._emit("loaderror",null,"Failed loading audio file with status: "+r.status+"."):void c(r.response,e)},r.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete d[t],e.load())},h(r)}},h=function(e){try{e.send()}catch(t){e.onerror()}},c=function(e,t){s.ctx.decodeAudioData(e,function(e){e&&t._sounds.length>0&&(d[t._src]=e,f(t,e))},function(){t._emit("loaderror",null,"Decoding audio data failed.")})},f=function(e,t){t&&!e._duration&&(e._duration=t.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue()),e._autoplay&&e.play()},p=function(){s.noAudio=!1;try{"undefined"!=typeof AudioContext?s.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?s.ctx=new webkitAudioContext:s.usingWebAudio=!1}catch(e){s.usingWebAudio=!1}if(!s.usingWebAudio)if("undefined"!=typeof Audio)try{var t=new Audio;"undefined"==typeof t.oncanplaythrough&&(s._canPlayEvent="canplay")}catch(e){s.noAudio=!0}else s.noAudio=!0;try{var t=new Audio;t.muted&&(s.noAudio=!0)}catch(e){}var n=/iP(hone|od|ad)/.test(s._navigator&&s._navigator.platform),i=s._navigator&&s._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),o=i?parseInt(i[1],10):null;if(n&&o&&o<9){var r=/safari/.test(s._navigator&&s._navigator.userAgent.toLowerCase());(s._navigator&&s._navigator.standalone&&!r||s._navigator&&!s._navigator.standalone&&!r)&&(s.usingWebAudio=!1)}s.usingWebAudio&&(s.masterGain="undefined"==typeof s.ctx.createGain?s.ctx.createGainNode():s.ctx.createGain(),s.masterGain.gain.value=1,s.masterGain.connect(s.ctx.destination)),s._setup()};i=[],o=function(){return{Howler:s,Howl:a}}.apply(t,i),!(void 0!==o&&(e.exports=o)),t.Howler=s,t.Howl=a,"undefined"!=typeof window?(window.HowlerGlobal=r,window.Howler=s,window.Howl=a,window.Sound=u):"undefined"!=typeof n&&(n.HowlerGlobal=r,n.Howler=s,n.Howl=a,n.Sound=u)}(),/*!
	 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
	 *  
	 *  howler.js v2.0.0
	 *  howlerjs.com
	 *
	 *  (c) 2013-2016, James Simpson of GoldFire Studios
	 *  goldfirestudios.com
	 *
	 *  MIT License
	 */
function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var t=this;if(!t.ctx||!t.ctx.listener)return t;for(var n=t._howls.length-1;n>=0;n--)t._howls[n].stereo(e);return t},HowlerGlobal.prototype.pos=function(e,t,n){var i=this;return i.ctx&&i.ctx.listener?(t="number"!=typeof t?i._pos[1]:t,n="number"!=typeof n?i._pos[2]:n,"number"!=typeof e?i._pos:(i._pos=[e,t,n],i.ctx.listener.setPosition(i._pos[0],i._pos[1],i._pos[2]),i)):i},HowlerGlobal.prototype.orientation=function(e,t,n,i,o,r){var s=this;if(!s.ctx||!s.ctx.listener)return s;var a=s._orientation;return t="number"!=typeof t?a[1]:t,n="number"!=typeof n?a[2]:n,i="number"!=typeof i?a[3]:i,o="number"!=typeof o?a[4]:o,r="number"!=typeof r?a[5]:r,"number"!=typeof e?a:(s._orientation=[e,t,n,i,o,r],s.ctx.listener.setOrientation(e,t,n,i,o,r),s)},Howl.prototype.init=function(e){return function(t){var n=this;return n._orientation=t.orientation||[1,0,0],n._stereo=t.stereo||null,n._pos=t.pos||null,n._pannerAttr={coneInnerAngle:"undefined"!=typeof t.coneInnerAngle?t.coneInnerAngle:360,coneOuterAngle:"undefined"!=typeof t.coneOuterAngle?t.coneOuterAngle:360,coneOuterGain:"undefined"!=typeof t.coneOuterGain?t.coneOuterGain:0,distanceModel:"undefined"!=typeof t.distanceModel?t.distanceModel:"inverse",maxDistance:"undefined"!=typeof t.maxDistance?t.maxDistance:1e4,panningModel:"undefined"!=typeof t.panningModel?t.panningModel:"HRTF",refDistance:"undefined"!=typeof t.refDistance?t.refDistance:1,rolloffFactor:"undefined"!=typeof t.rolloffFactor?t.rolloffFactor:1},n._onstereo=t.onstereo?[{fn:t.onstereo}]:[],n._onpos=t.onpos?[{fn:t.onpos}]:[],n._onorientation=t.onorientation?[{fn:t.onorientation}]:[],e.call(this,t)}}(Howl.prototype.init),Howl.prototype.stereo=function(t,n){var i=this;if(!i._webAudio)return i;if("loaded"!==i._state)return i._queue.push({event:"stereo",action:function(){i.stereo(t,n)}}),i;var o="undefined"==typeof Howler.ctx.createStereoPanner?"spatial":"stereo";if("undefined"==typeof n){if("number"!=typeof t)return i._stereo;i._stereo=t,i._pos=[t,0,0]}for(var r=i._getSoundIds(n),s=0;s<r.length;s++){var a=i._soundById(r[s]);if(a){if("number"!=typeof t)return a._stereo;a._stereo=t,a._pos=[t,0,0],a._node&&(a._pannerAttr.panningModel="equalpower",a._panner&&a._panner.pan||e(a,o),"spatial"===o?a._panner.setPosition(t,0,0):a._panner.pan.value=t),i._emit("stereo",a._id)}}return i},Howl.prototype.pos=function(t,n,i,o){var r=this;if(!r._webAudio)return r;if("loaded"!==r._state)return r._queue.push({event:"pos",action:function(){r.pos(t,n,i,o)}}),r;if(n="number"!=typeof n?0:n,i="number"!=typeof i?-.5:i,"undefined"==typeof o){if("number"!=typeof t)return r._pos;r._pos=[t,n,i]}for(var s=r._getSoundIds(o),a=0;a<s.length;a++){var u=r._soundById(s[a]);if(u){if("number"!=typeof t)return u._pos;u._pos=[t,n,i],u._node&&(u._panner&&!u._panner.pan||e(u,"spatial"),u._panner.setPosition(t,n,i)),r._emit("pos",u._id)}}return r},Howl.prototype.orientation=function(t,n,i,o){var r=this;if(!r._webAudio)return r;if("loaded"!==r._state)return r._queue.push({event:"orientation",action:function(){r.orientation(t,n,i,o)}}),r;if(n="number"!=typeof n?r._orientation[1]:n,i="number"!=typeof i?r._orientation[2]:i,"undefined"==typeof o){if("number"!=typeof t)return r._orientation;r._orientation=[t,n,i]}for(var s=r._getSoundIds(o),a=0;a<s.length;a++){var u=r._soundById(s[a]);if(u){if("number"!=typeof t)return u._orientation;u._orientation=[t,n,i],u._node&&(u._panner||(u._pos||(u._pos=r._pos||[0,0,-.5]),e(u,"spatial")),u._panner.setOrientation(t,n,i)),r._emit("orientation",u._id)}}return r},Howl.prototype.pannerAttr=function(){var t,n,i,o=this,s=arguments;if(!o._webAudio)return o;if(0===s.length)return o._pannerAttr;if(1===s.length){if("object"!==r(s[0]))return i=o._soundById(parseInt(s[0],10)),i?i._pannerAttr:o._pannerAttr;t=s[0],"undefined"==typeof n&&(o._pannerAttr={coneInnerAngle:"undefined"!=typeof t.coneInnerAngle?t.coneInnerAngle:o._coneInnerAngle,coneOuterAngle:"undefined"!=typeof t.coneOuterAngle?t.coneOuterAngle:o._coneOuterAngle,coneOuterGain:"undefined"!=typeof t.coneOuterGain?t.coneOuterGain:o._coneOuterGain,distanceModel:"undefined"!=typeof t.distanceModel?t.distanceModel:o._distanceModel,maxDistance:"undefined"!=typeof t.maxDistance?t.maxDistance:o._maxDistance,panningModel:"undefined"!=typeof t.panningModel?t.panningModel:o._panningModel,refDistance:"undefined"!=typeof t.refDistance?t.refDistance:o._refDistance,rolloffFactor:"undefined"!=typeof t.rolloffFactor?t.rolloffFactor:o._rolloffFactor})}else 2===s.length&&(t=s[0],n=parseInt(s[1],10));for(var a=o._getSoundIds(n),u=0;u<a.length;u++)if(i=o._soundById(a[u])){var d=i._pannerAttr;d={coneInnerAngle:"undefined"!=typeof t.coneInnerAngle?t.coneInnerAngle:d.coneInnerAngle,coneOuterAngle:"undefined"!=typeof t.coneOuterAngle?t.coneOuterAngle:d.coneOuterAngle,coneOuterGain:"undefined"!=typeof t.coneOuterGain?t.coneOuterGain:d.coneOuterGain,distanceModel:"undefined"!=typeof t.distanceModel?t.distanceModel:d.distanceModel,maxDistance:"undefined"!=typeof t.maxDistance?t.maxDistance:d.maxDistance,panningModel:"undefined"!=typeof t.panningModel?t.panningModel:d.panningModel,refDistance:"undefined"!=typeof t.refDistance?t.refDistance:d.refDistance,rolloffFactor:"undefined"!=typeof t.rolloffFactor?t.rolloffFactor:d.rolloffFactor};var l=i._panner;l?(l.coneInnerAngle=d.coneInnerAngle,l.coneOuterAngle=d.coneOuterAngle,l.coneOuterGain=d.coneOuterGain,l.distanceModel=d.distanceModel,l.maxDistance=d.maxDistance,l.panningModel=d.panningModel,l.refDistance=d.refDistance,l.rolloffFactor=d.rolloffFactor):(i._pos||(i._pos=o._pos||[0,0,-.5]),e(i,"spatial"))}return o},Sound.prototype.init=function(e){return function(){var t=this,n=t._parent;t._orientation=n._orientation,t._stereo=n._stereo,t._pos=n._pos,t._pannerAttr=n._pannerAttr,e.call(this),t._stereo?n.stereo(t._stereo):t._pos&&n.pos(t._pos[0],t._pos[1],t._pos[2],t._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var t=this,n=t._parent;return t._orientation=n._orientation,t._pos=n._pos,t._pannerAttr=n._pannerAttr,e.call(this)}}(Sound.prototype.reset);var e=function(e,t){t=t||"spatial","spatial"===t?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.panningModel=e._pannerAttr.panningModel,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.value=e._stereo),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id)}}()}).call(t,function(){return this}())},function(e,t,n){var i,o,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};!function(s){if("object"===r(t))e.exports=s();else{i=s,o="function"==typeof i?i.call(t,n,t,e):i,!(void 0!==o&&(e.exports=o))}}(function(e){"use strict";function t(e,t,n,i,o,r){return t=v(v(t,e),v(i,r)),v(t<<o|t>>>32-o,n)}function n(e,n,i,o,r,s,a){return t(n&i|~n&o,e,n,r,s,a)}function i(e,n,i,o,r,s,a){return t(n&o|i&~o,e,n,r,s,a)}function o(e,n,i,o,r,s,a){return t(n^i^o,e,n,r,s,a)}function r(e,n,i,o,r,s,a){return t(i^(n|~o),e,n,r,s,a)}function s(e,t){var s=e[0],a=e[1],u=e[2],d=e[3];s=n(s,a,u,d,t[0],7,-680876936),d=n(d,s,a,u,t[1],12,-389564586),u=n(u,d,s,a,t[2],17,606105819),a=n(a,u,d,s,t[3],22,-1044525330),s=n(s,a,u,d,t[4],7,-176418897),d=n(d,s,a,u,t[5],12,1200080426),u=n(u,d,s,a,t[6],17,-1473231341),a=n(a,u,d,s,t[7],22,-45705983),s=n(s,a,u,d,t[8],7,1770035416),d=n(d,s,a,u,t[9],12,-1958414417),u=n(u,d,s,a,t[10],17,-42063),a=n(a,u,d,s,t[11],22,-1990404162),s=n(s,a,u,d,t[12],7,1804603682),d=n(d,s,a,u,t[13],12,-40341101),u=n(u,d,s,a,t[14],17,-1502002290),a=n(a,u,d,s,t[15],22,1236535329),s=i(s,a,u,d,t[1],5,-165796510),d=i(d,s,a,u,t[6],9,-1069501632),u=i(u,d,s,a,t[11],14,643717713),a=i(a,u,d,s,t[0],20,-373897302),s=i(s,a,u,d,t[5],5,-701558691),d=i(d,s,a,u,t[10],9,38016083),u=i(u,d,s,a,t[15],14,-660478335),a=i(a,u,d,s,t[4],20,-405537848),s=i(s,a,u,d,t[9],5,568446438),d=i(d,s,a,u,t[14],9,-1019803690),u=i(u,d,s,a,t[3],14,-187363961),a=i(a,u,d,s,t[8],20,1163531501),s=i(s,a,u,d,t[13],5,-1444681467),d=i(d,s,a,u,t[2],9,-51403784),u=i(u,d,s,a,t[7],14,1735328473),a=i(a,u,d,s,t[12],20,-1926607734),s=o(s,a,u,d,t[5],4,-378558),d=o(d,s,a,u,t[8],11,-2022574463),u=o(u,d,s,a,t[11],16,1839030562),a=o(a,u,d,s,t[14],23,-35309556),s=o(s,a,u,d,t[1],4,-1530992060),d=o(d,s,a,u,t[4],11,1272893353),u=o(u,d,s,a,t[7],16,-155497632),a=o(a,u,d,s,t[10],23,-1094730640),s=o(s,a,u,d,t[13],4,681279174),d=o(d,s,a,u,t[0],11,-358537222),u=o(u,d,s,a,t[3],16,-722521979),a=o(a,u,d,s,t[6],23,76029189),s=o(s,a,u,d,t[9],4,-640364487),d=o(d,s,a,u,t[12],11,-421815835),u=o(u,d,s,a,t[15],16,530742520),a=o(a,u,d,s,t[2],23,-995338651),s=r(s,a,u,d,t[0],6,-198630844),d=r(d,s,a,u,t[7],10,1126891415),u=r(u,d,s,a,t[14],15,-1416354905),a=r(a,u,d,s,t[5],21,-57434055),s=r(s,a,u,d,t[12],6,1700485571),d=r(d,s,a,u,t[3],10,-1894986606),u=r(u,d,s,a,t[10],15,-1051523),a=r(a,u,d,s,t[1],21,-2054922799),s=r(s,a,u,d,t[8],6,1873313359),d=r(d,s,a,u,t[15],10,-30611744),u=r(u,d,s,a,t[6],15,-1560198380),a=r(a,u,d,s,t[13],21,1309151649),s=r(s,a,u,d,t[4],6,-145523070),d=r(d,s,a,u,t[11],10,-1120210379),u=r(u,d,s,a,t[2],15,718787259),a=r(a,u,d,s,t[9],21,-343485551),e[0]=v(s,e[0]),e[1]=v(a,e[1]),e[2]=v(u,e[2]),e[3]=v(d,e[3])}function a(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}function u(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e[t]+(e[t+1]<<8)+(e[t+2]<<16)+(e[t+3]<<24);return n}function d(e){var t,n,i,o,r,u,d=e.length,l=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=d;t+=64)s(l,a(e.substring(t-64,t)));for(e=e.substring(t-64),n=e.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;t<n;t+=1)i[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(i[t>>2]|=128<<(t%4<<3),t>55)for(s(l,i),t=0;t<16;t+=1)i[t]=0;return o=8*d,o=o.toString(16).match(/(.*?)(.{0,8})$/),r=parseInt(o[2],16),u=parseInt(o[1],16)||0,i[14]=r,i[15]=u,s(l,i),l}function l(e){var t,n,i,o,r,a,d=e.length,l=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=d;t+=64)s(l,u(e.subarray(t-64,t)));for(e=t-64<d?e.subarray(t-64):new Uint8Array(0),n=e.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;t<n;t+=1)i[t>>2]|=e[t]<<(t%4<<3);if(i[t>>2]|=128<<(t%4<<3),t>55)for(s(l,i),t=0;t<16;t+=1)i[t]=0;return o=8*d,o=o.toString(16).match(/(.*?)(.{0,8})$/),r=parseInt(o[2],16),a=parseInt(o[1],16)||0,i[14]=r,i[15]=a,s(l,i),l}function h(e){var t,n="";for(t=0;t<4;t+=1)n+=b[e>>8*t+4&15]+b[e>>8*t&15];return n}function c(e){var t;for(t=0;t<e.length;t+=1)e[t]=h(e[t]);return e.join("")}function f(e){return/[\u0080-\uFFFF]/.test(e)&&(e=unescape(encodeURIComponent(e))),e}function p(e,t){var n,i=e.length,o=new ArrayBuffer(i),r=new Uint8Array(o);for(n=0;n<i;n+=1)r[n]=e.charCodeAt(n);return t?r:o}function _(e){return String.fromCharCode.apply(null,new Uint8Array(e))}function m(e,t,n){var i=new Uint8Array(e.byteLength+t.byteLength);return i.set(new Uint8Array(e)),i.set(new Uint8Array(t),e.byteLength),n?i:i.buffer}function y(e){var t,n=[],i=e.length;for(t=0;t<i-1;t+=2)n.push(parseInt(e.substr(t,2),16));return String.fromCharCode.apply(String,n)}function g(){this.reset()}var v=function(e,t){return e+t&4294967295},b=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==c(d("hello"))&&(v=function(e,t){var n=(65535&e)+(65535&t),i=(e>>16)+(t>>16)+(n>>16);return i<<16|65535&n}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function t(e,t){return e=0|e||0,e<0?Math.max(e+t,0):Math.min(e,t)}ArrayBuffer.prototype.slice=function(n,i){var o,r,s,a,u=this.byteLength,d=t(n,u),l=u;return i!==e&&(l=t(i,u)),d>l?new ArrayBuffer(0):(o=l-d,r=new ArrayBuffer(o),s=new Uint8Array(r),a=new Uint8Array(this,d,o),s.set(a),r)}}(),g.prototype.append=function(e){return this.appendBinary(f(e)),this},g.prototype.appendBinary=function(e){this._buff+=e,this._length+=e.length;var t,n=this._buff.length;for(t=64;t<=n;t+=64)s(this._hash,a(this._buff.substring(t-64,t)));return this._buff=this._buff.substring(t-64),this},g.prototype.end=function(e){var t,n,i=this._buff,o=i.length,r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<o;t+=1)r[t>>2]|=i.charCodeAt(t)<<(t%4<<3);return this._finish(r,o),n=c(this._hash),e&&(n=y(n)),this.reset(),n},g.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},g.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},g.prototype.setState=function(e){return this._buff=e.buff,this._length=e.length,this._hash=e.hash,this},g.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},g.prototype._finish=function(e,t){var n,i,o,r=t;if(e[r>>2]|=128<<(r%4<<3),r>55)for(s(this._hash,e),r=0;r<16;r+=1)e[r]=0;n=8*this._length,n=n.toString(16).match(/(.*?)(.{0,8})$/),i=parseInt(n[2],16),o=parseInt(n[1],16)||0,e[14]=i,e[15]=o,s(this._hash,e)},g.hash=function(e,t){return g.hashBinary(f(e),t)},g.hashBinary=function(e,t){var n=d(e),i=c(n);return t?y(i):i},g.ArrayBuffer=function(){this.reset()},g.ArrayBuffer.prototype.append=function(e){var t,n=m(this._buff.buffer,e,!0),i=n.length;for(this._length+=e.byteLength,t=64;t<=i;t+=64)s(this._hash,u(n.subarray(t-64,t)));return this._buff=t-64<i?new Uint8Array(n.buffer.slice(t-64)):new Uint8Array(0),this},g.ArrayBuffer.prototype.end=function(e){var t,n,i=this._buff,o=i.length,r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<o;t+=1)r[t>>2]|=i[t]<<(t%4<<3);return this._finish(r,o),n=c(this._hash),e&&(n=y(n)),this.reset(),n},g.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},g.ArrayBuffer.prototype.getState=function(){var e=g.prototype.getState.call(this);return e.buff=_(e.buff),e},g.ArrayBuffer.prototype.setState=function(e){return e.buff=p(e.buff,!0),g.prototype.setState.call(this,e)},g.ArrayBuffer.prototype.destroy=g.prototype.destroy,g.ArrayBuffer.prototype._finish=g.prototype._finish,g.ArrayBuffer.hash=function(e,t){var n=l(new Uint8Array(e)),i=c(n);return t?y(i):i},g})},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(){this.resizeTasks=[]}Object.defineProperty(t,"__esModule",{value:!0});var r=n(16),s=i(r);o.prototype.resizeComponents=function(){var e=(0,s["default"])(this.aspectWidth,this.aspectHeight,this.appSpace.offsetWidth,this.appSpace.offsetHeight),t=e.width+"px",n=e.height+"px";this.appContainer.style.width=t,this.appContainer.style.height=n,this.appCanvas.style.width=t,this.appCanvas.style.height=n,this.appCanvas.width=e.width,this.appCanvas.height=e.height},o.prototype.handleResize=function(){for(var e=this.resizeTasks.length,t=0;t<e;t++)this.resizeTasks[t]()},o.prototype.bindHandleResize=function(e){this.bindHandleResizeTarget=e,this.handleResizeBound=this.handleResize.bind(this),this.bindHandleResizeTarget.addEventListener("resize",this.handleResizeBound)},o.prototype.unbindHandleResize=function(){this.bindHandleResizeTarget.removeEventListener("resize",this.handleResizeBound)},t["default"]=o},function(e,t,n){"use strict";function i(e){this.urls=e.urls,"number"==typeof e.volume&&e.volume>=0&&e.volume<=1?this.volume=e.volume:this.volume=.5,"function"==typeof e.onload?this.onload=e.onload:this.onload=function(){},"function"==typeof e.onloaderror?this.onloaderror=e.onloaderror:this.onloaderror=function(){},"number"==typeof e.fadeInDuration&&e.fadeInDuration>=0?this.fadeInDuration=e.fadeInDuration:this.fadeInDuration=500,"number"==typeof e.fadeOutDuration&&e.fadeOutDuration>=0?this.fadeOutDuration=e.fadeOutDuration:this.fadeOutDuration=600,"function"==typeof e.fadeInCallback?this.fadeInCallback=e.fadeInCallback:this.fadeInCallback=function(){},"function"==typeof e.fadeOutCallback?this.fadeOutCallback=e.fadeOutCallback:this.fadeOutCallback=function(){},this.howl=new Howl({src:this.urls,autoplay:!1,loop:!0,volume:this.volume,onload:this.onload,onloaderror:this.onloaderror}),this.playing=!1,this.fading=!1}Object.defineProperty(t,"__esModule",{value:!0}),n(5),i.prototype.play=function(){this.playing||this.fading?console.log("AudioLooper will not play--already playing and/or fading"):(this.playing=!0,this.howl.play())},i.prototype.pause=function(){this.playing&&!this.fading?(this.playing=!1,this.howl.pause()):console.log("AudioLooper will not pause--either not playing or is fading")},i.prototype.stop=function(){this.playing=!1,this.fading=!1,this.howl.stop()},i.prototype.fadeIn=function(){this.playing?console.log("AudioLooper will not fade in--already playing"):(this.howl.volume(0),this.howl.play(),this.howl.off("fade"),this.howl.on("fade",function(){this.fading=!1,this.fadeInCallback()}.bind(this)),this.howl.fade(0,this.volume,this.fadeInDuration),this.playing=!0,this.fading=!0)},i.prototype.fadeOut=function(){this.playing?(this.howl.off("fade"),this.howl.on("fade",function(){this.howl.pause(),this.playing=!1,this.fading=!1,this.fadeOutCallback()}.bind(this)),this.howl.fade(this.howl.volume(),.1,this.fadeOutDuration),this.fading=!0):console.log("AudioLooper will not fade out--not playing")},t["default"]=i},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(){this.panelColors=[]}Object.defineProperty(t,"__esModule",{value:!0});var r=n(4);i(r);o.renderPanelGroup=function(e,t){e.save();for(var n=t.panelWidth/t.panelHeight,i=0;i<t.numPanels;i++){var o=i%t.panelColors.length;e.fillStyle=t.panelColors[o].toString(),e.fillRect(i*n,0,n,1)}e.restore()},o.prototype.renderPanelGroup=function(e){o.renderPanelGroup(e,this)},o.renderTileColumn=function(e,t){e.save();var n=1/t.numTileRows;e.scale(n,n);for(var i=0;i<t.numTileRows;i++)t.tile.render(e),e.translate(0,1);e.restore()},o.prototype.renderTileColumn=function(e){o.renderTileColumn(e,this)},t["default"]=o},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e,t,n){return Math.max(Math.min(e,n),t)}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={LEFT:{ID:37,NAME:""},UP:{ID:38,NAME:""},RIGHT:{ID:39,NAME:""},DOWN:{ID:40,NAME:""},MOD:{ID:16,NAME:"Shift"},ACTION:{ID:90,NAME:"Z"},ACTION2:{ID:88,NAME:"X"},ACTION3:{ID:67,NAME:"C"},CONFIRM:{ID:32,NAME:"Space"},CONFIRM2:{ID:13,NAME:"Enter"},CANCEL:{ID:27,NAME:"Esc"}}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){this.c=e,this.ctx=t,this.panelsC=document.createElement("canvas"),this.panelsCtx=this.panelsC.getContext("2d"),this.tilesC=document.createElement("canvas"),this.tilesCtx=this.tilesC.getContext("2d"),this.playerSideLength=.1,this.playerWalkSpeed=.017,this.playerRunSpeed=.029,this.playerXMoveFactor=.6,this.playerAirFactor=.8,this.maxJumpCycles=10,this.jumpRate=.0059,this.fallRate=.003,this.killBounce=.05,this.numPanels={min:3,max:14},this.panelWidthLimits={min:.12,max:.7},this.panelHeightLimits={min:.06,max:.18},this.numTileRows={min:1,max:5},this.tileFactor=.5,this.limits={},this.outCircleFactor=.8,this.overRedOpacityRate=.015,this.fadeInFactor=.9,this.isDyingCallback=function(){},this.nightmareMode=!1,this.gameLoop=new u["default"](this.gameWork.bind(this)),this.dieLoop=new u["default"](this.dieWork.bind(this)),this.fadeInLoop=new u["default"](this.fadeInWork.bind(this)),this.drawFinalFrameBound=this.drawFinalFrame.bind(this)}Object.defineProperty(t,"__esModule",{value:!0});var r=n(20),s=i(r),a=n(3),u=i(a),d=n(2),l=i(d),h=n(10),c=i(h),f=n(1),p=i(f),_=n(4),m=i(_),y=n(9),g=i(y),v=n(19),b=i(v),w=n(22),x=i(w);o.prototype.randomBackdrop=function(e){var t=new g["default"];t.numPanels=e.randomInt(this.numPanels.min,this.numPanels.max);for(var n=0;n<t.numPanels;n++){var i=p["default"].random(e.randomInt.bind(e));t.panelColors.push(i)}return t.panelWidth=e.randomInRange(this.panelWidthLimits.min,this.panelWidthLimits.max),t.panelHeight=e.randomInRange(this.panelHeightLimits.min,this.panelHeightLimits.max),t.numTileRows=e.randomInt(this.numTileRows.min,this.numTileRows.max),t.tileLength=(1-2*t.panelHeight)/t.numTileRows,t.tile=m["default"].random(e),t},o.prototype.bakeBackdrop=function(e){this.panelHeight=Math.round(e.panelHeight*this.c.height),this.tileColumnHeight=this.c.height-2*this.panelHeight,this.panelGroupWidth=e.numPanels*e.panelWidth,this.numPanelGroups=1+Math.ceil(this.aspectWidth/this.aspectHeight/this.panelGroupWidth),this.numTileColumns=1+Math.ceil(this.aspectWidth/this.aspectHeight/e.tileLength),this.panelsC.width=Math.floor(this.numPanelGroups*this.panelGroupWidth*this.c.height),this.panelsC.height=this.panelHeight,this.tilesC.width=Math.floor(this.numTileColumns*e.tileLength*this.c.height),this.tilesC.height=this.tileColumnHeight,this.panelsCtx.save(),this.panelsCtx.scale(this.panelHeight,this.panelHeight);for(var t=e.panelWidth/e.panelHeight*e.numPanels,n=0;n<this.numPanelGroups;n++)e.renderPanelGroup(this.panelsCtx),this.panelsCtx.translate(t,0);this.panelsCtx.restore(),this.tilesCtx.save(),this.tilesCtx.scale(this.tileColumnHeight,this.tileColumnHeight);for(var i=1/e.numTileRows,n=0;n<this.numTileColumns;n++)e.renderTileColumn(this.tilesCtx),this.tilesCtx.translate(i,0);this.tilesCtx.restore()},o.prototype.prepLevel=function(e){this.backdrop=this.randomBackdrop(this.srng),this.bakeBackdrop(this.backdrop),this.camera={},this.camera.pos={x:0,y:0},this.camera.limits={},this.camera.limits.x={min:0,max:9},this.limits.x={},this.limits.x.min=0,this.limits.x.max=this.camera.limits.x.max+this.aspectWidth/this.aspectHeight,this.limits.y={},this.limits.y.min=this.backdrop.panelHeight,this.limits.y.max=1-this.backdrop.panelHeight,this.ceilingY=this.limits.y.min+this.playerSideLength/2,this.groundY=this.limits.y.max-this.playerSideLength/2,this.player=new s["default"](this.backdrop.panelWidth/2,this.groundY,this.playerSideLength,0),this.playerGrounded=!0,this.patrols=[],this.numPatrols=Math.min(3+4*e,32);for(var t=0;t<this.numPatrols;t++){var n=this.playerSideLength*this.srng.randomInRange(.4,Math.min(.3+.1*e,.8)),i=this.srng.randomInRange(3*this.backdrop.panelWidth+n,this.limits.x.max),o=this.limits.y.max-n,r=this.srng.randomInRange(2*this.backdrop.panelWidth+n,this.limits.x.max),a=this.limits.y.max-n,u=this.playerWalkSpeed*this.srng.randomInRange(.2,Math.min(.1+.1*e,.6)),d=new b["default"](i,o,n,{x:r,y:a},{x:i,y:o},u);this.patrols.push(d)}},o.prototype.startGame=function(e){this.srng=new l["default"](e),this.kills=0,this.level=1,this.streak=0,this.highestStreak=0,this.fadeInLoop.timestepper.reset(),this.gameLoop.timestepper.reset(),this.playerCamMinOffset=this.aspectWidth/this.aspectHeight*.45,this.playerCamMaxOffset=this.aspectWidth/this.aspectHeight*.55,this.jumpCycles=0,this.prepLevel(this.level),this.dead=!1,this.fadeInLoop.stopCallback=function(){this.gameLoop.start()}.bind(this),this.fadeInOpacity=1,this.fadeInLoop.start()},o.prototype.drawTiles=function(){this.tileXOffset=this.camera.pos.x*this.tileFactor%this.backdrop.tileLength,this.ctx.save(),this.ctx.translate(-this.tileXOffset*this.c.height,0),this.ctx.drawImage(this.tilesC,0,0,this.tilesC.width,this.tilesC.height,0,this.panelsC.height,this.tilesC.width,this.tilesC.height),this.ctx.restore()},o.prototype.drawPanels=function(){this.panelXOffset=this.camera.pos.x%this.panelGroupWidth,this.ctx.save(),this.ctx.translate(-this.panelXOffset*this.c.height,0),this.ctx.drawImage(this.panelsC,0,0,this.panelsC.width,this.panelsC.height,0,0,this.panelsC.width,this.panelsC.height),this.ctx.translate(0,this.c.height),this.ctx.scale(1,-1),this.ctx.drawImage(this.panelsC,0,0,this.panelsC.width,this.panelsC.height,0,0,this.panelsC.width,this.panelsC.height),this.ctx.restore()},o.prototype.drawBackdrop=function(){this.drawTiles(),this.drawPanels()},o.prototype.drawPlayer=function(){this.ctx.save(),this.ctx.scale(this.c.height,this.c.height),this.ctx.translate(-this.camera.pos.x,-this.camera.pos.y),this.player.draw(this.ctx),this.ctx.restore()},o.prototype.drawPatrols=function(){this.ctx.save(),this.ctx.scale(this.c.height,this.c.height),this.ctx.translate(-this.camera.pos.x,-this.camera.pos.y);for(var e=this.patrols.length,t=0;t<e;t++)this.patrols[t].draw(this.ctx);this.ctx.restore()},o.prototype.gameWork=function(){var e=0;this.kb.keydown[this.keys.RIGHT.ID]===!0&&(e+=1),this.kb.keydown[this.keys.LEFT.ID]===!0&&(e-=1);var t;t=this.kb.keydown[this.keys.MOD.ID]===!0?this.playerRunSpeed:this.playerWalkSpeed;var n=this.playerGrounded?1:this.playerAirFactor;this.player.vel.x+=e*t*n,this.player.vel.x*=this.playerXMoveFactor,this.player.pos.x+=this.player.vel.x,this.player.pos.x<0&&(this.player.pos.x=0),this.kb.keydown[this.keys.UP.ID]!==!0&&this.kb.keydown[this.keys.ACTION.ID]!==!0&&this.kb.keydown[this.keys.CONFIRM.ID]!==!0||this.jumpCycles<this.maxJumpCycles&&(this.jumpCycles+=1,this.player.vel.y-=this.jumpRate),this.player.vel.y+=this.fallRate,this.player.pos.y+=this.player.vel.y,this.player.pos.y>=this.groundY?(this.player.pos.y=this.groundY,this.player.vel.y=0,this.jumpCycles=0,this.streak=0,this.playerGrounded=!0):(this.playerGrounded=!1,this.player.pos.y<=this.ceilingY&&(this.player.pos.y=this.ceilingY,this.player.vel.y=0)),this.playerCamDiff=this.player.pos.x-this.camera.pos.x,this.playerCamDiff<this.playerCamMinOffset?this.camera.pos.x=this.player.pos.x-this.playerCamMinOffset:this.playerCamDiff>this.playerCamMaxOffset&&(this.camera.pos.x=this.player.pos.x-this.playerCamMaxOffset),this.camera.pos.x=(0,c["default"])(this.camera.pos.x,this.camera.limits.x.min,this.camera.limits.x.max);for(var i=this.patrols.length,o=0;o<i;o++)this.patrols[o].move();var r=0;if(this.patrols.forEach(function(e){var t=Math.atan2(e.pos.y-this.player.pos.y,e.pos.x-this.player.pos.x),n=this.player.getRadius(t)+e.radius,i=x["default"].distance(this.player.pos,e.pos);if(i<n){var o=Math.atan2(this.player.vel.y,this.player.vel.x);this.player.pos.y<e.pos.y&&o>0&&o<Math.PI?(r+=1,this.kills+=1,this.patrols.splice(this.patrols.indexOf(e),1)):this.dead=!0}}.bind(this)),r>0&&(this.player.vel.y=r*-this.killBounce,this.streak+=r,this.streak>this.highestStreak&&(this.highestStreak=this.streak)),this.nightmareMode){this.ctx.save();var s=(new Date).getTime();this.ctx.translate(this.c.width/2,this.c.height/2),this.ctx.rotate(Math.PI/32*Math.sin(s/1200));var a=.65+.25*Math.cos(s/600);this.ctx.scale(a,a),this.ctx.translate(-this.c.width/2,-this.c.height/2),this.drawBackdrop(),this.drawPlayer(),this.drawPatrols(),this.ctx.restore()}else this.drawBackdrop(),this.drawPlayer(),this.drawPatrols();this.dead?(this.isDyingCallback(),this.die()):this.player.pos.x>this.limits.x.max&&(this.gameLoop.stopCallback=function(){this.level+=1,this.prepLevel(this.level),this.fadeInLoop.stopCallback=function(){this.gameLoop.start()}.bind(this),this.fadeInOpacity=1,this.fadeInLoop.start()}.bind(this),this.gameLoop.stop())},o.prototype.die=function(){this.totalTime=this.fadeInLoop.timestepper.totalTime+this.gameLoop.timestepper.totalTime,this.speed=(this.level-1)/(this.totalTime/1e3/60),this.outCircleRadius=this.c.width,this.playerX=this.player.pos.x-this.camera.pos.x,this.overRedOpacity=0,this.fadeInLoop.looping?(this.fadeInLoop.stopCallback=function(){this.dieLoop.start()}.bind(this),this.fadeInLoop.stop()):(this.gameLoop.stopCallback=function(){this.dieLoop.start()}.bind(this),this.gameLoop.stop())},o.prototype.dieWork=function(){this.outCircleRadius*=this.outCircleFactor+(.99-this.outCircleFactor)*(1-this.outCircleRadius/this.c.width),this.overRedOpacity+=this.overRedOpacityRate,this.overRedOpacity=Math.min(.6,this.overRedOpacity),this.ctx.save(),this.ctx.globalCompositeOperation="hard-light",this.drawBackdrop(),this.drawPlayer(),this.drawPatrols(),this.ctx.fillStyle="rgba(152, 8, 8, "+this.overRedOpacity+")",this.ctx.fillRect(0,0,this.c.width,this.c.height),this.ctx.beginPath(),this.ctx.rect(0,0,this.c.width,this.c.height),this.ctx.arc(this.playerX*this.c.height,this.player.pos.y*this.c.height,this.outCircleRadius,0,2*Math.PI,!0),this.ctx.fillStyle="#000",this.ctx.fill(),this.ctx.closePath(),this.ctx.restore(),this.outCircleRadius<2*this.player.sideLength*this.c.height&&this.dieLoop.stop()},o.prototype.fadeInWork=function(){this.fadeInOpacity*=this.fadeInFactor,this.fadeInOpacity<0&&(this.fadeInOpacity=0),this.gameWork(),this.ctx.save(),this.ctx.fillStyle="rgba(0, 0, 0, "+this.fadeInOpacity+")",this.ctx.fillRect(0,0,this.c.width,this.c.height),this.ctx.restore(),this.fadeInOpacity<.05&&this.fadeInLoop.stop()},o.prototype.drawFinalFrame=function(){this.ctx.save(),this.ctx.scale(this.c.width,this.c.height),this.ctx.drawImage(this.finalFrame,0,0,1,1),this.ctx.restore()},o.prototype.handleResize=function(){void 0!=this.backdrop&&this.bakeBackdrop(this.backdrop)},t["default"]=o},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e){"string"==typeof e?this.seed=e:this.seed="",this.currentHash=s["default"].hash(this.seed),this.currentHashLeft=this.currentHash,this.numHashes=1}Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),s=i(r);o.HASH_LENGTH=32,o.prototype.reset=function(){this.currentHash=s["default"].hash(this.seed),this.currentHashLeft=this.currentHash,this.numHashes=1},o.prototype.rehash=function(){this.currentHash=s["default"].hash(this.currentHash),this.currentHashLeft=this.currentHash,this.numHashes+=1},o.prototype.getHash=function(e){if("number"!=typeof e)throw"Non-NumberLength";if(e<0)throw"NegativeLength";if(0===e)return"";var t;if(this.currentHashLeft.length>=e)t=this.currentHashLeft.substr(0,e),this.currentHashLeft=this.currentHashLeft.substr(e,this.currentHashLeft.length);else{t=this.currentHashLeft;var n=e-t.length,i=Math.floor(n/o.HASH_LENGTH);if(i>0){for(var r=0;r<i;r++)this.rehash(),t+=this.currentHash;n-=i*o.HASH_LENGTH,n>0?(this.rehash(),t+=this.currentHashLeft.substr(0,n),this.currentHashLeft=this.currentHashLeft.substr(n,this.currentHashLeft.length)):this.currentHashLeft=""}else this.rehash(),t+=this.currentHashLeft.substr(0,n),this.currentHashLeft=this.currentHashLeft.substr(n,this.currentHashLeft.length)}return t},t["default"]=o},function(e,t){"use strict";function n(e){this.target=e,this.keydown={},this.listening=!1,this.keydownEvent=this.handleKeydown.bind(this),this.keyupEvent=this.handleKeyup.bind(this)}Object.defineProperty(t,"__esModule",{value:!0}),n.prototype.clear=function(){this.keydown={}},n.getKeyIdentifier=function(e){return e.keyCode},n.prototype.handleKeydown=function(e){var t=n.getKeyIdentifier(e);this.keydown[t]=!0},n.prototype.handleKeyup=function(e){var t=n.getKeyIdentifier(e);this.keydown[t]=!1},n.prototype.startListen=function(){this.listening=!0,this.target.addEventListener("keydown",this.keydownEvent),this.target.addEventListener("keyup",this.keyupEvent)},n.prototype.stopListen=function(){this.target.removeEventListener("keydown",this.keydownEvent),this.target.removeEventListener("keyup",this.keyupEvent),this.listening=!1},t["default"]=n},function(e,t){"use strict";function n(e,t,n,i){this.target=e,this.eventType=t,this.work=n,this.active=!1,void 0==i?this.newBind=!1:(this.thisObject=i,this.newBind=!0),this.newBind&&(this.workBound=n.bind(this.thisObject))}Object.defineProperty(t,"__esModule",{value:!0}),n.prototype.start=function(){if(this.active)throw{name:"State error",message:"Not going to start listener system--already active"};this.newBind?this.target.addEventListener(this.eventType,this.workBound):this.target.addEventListener(this.eventType,this.work),this.active=!0;
},n.prototype.stop=function(){if(!this.active)throw{name:"State error",message:"Not going to stop listener system--already inactive"};this.newBind?this.target.removeEventListener(this.eventType,this.workBound):this.target.removeEventListener(this.eventType,this.work),this.active=!1},t["default"]=n},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e,t,n,i){if(e<0||t<0||0===e&&0===t)return{width:0,height:0};if(0===e)return{width:0,height:i};if(0===t)return{width:n,height:0};if(n<=0||i<=0)return{width:0,height:0};var o,r,s=e/t,a=n/i;if(s===a)o=n,r=i;else if(s<a){var u=Math.floor(i/t);o=u*e,r=u*t}else if(s>a){var u=Math.floor(n/e);o=u*e,r=u*t}return{width:o,height:r}}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e,t){return Math.pow(t,e)-1}},function(e,t){"use strict";function n(e,t,n,i,o,r,s){this.name=e,this.element=t,this.showZ=n,this.hideZ=i,this.listenerSystems=o||[],this.listenerSystemsActive=!1,this.showWork=r||function(){},this.hideWork=s||function(){}}Object.defineProperty(t,"__esModule",{value:!0}),n.prototype.show=function(){this.element.style["z-index"]=this.showZ,this.element.style.visibility="visible",this.startListenerSystems(),this.showWork()},n.prototype.hide=function(){this.element.style["z-index"]=this.hideZ,this.element.style.visibility="hidden",this.stopListenerSystems(),this.hideWork()},n.prototype.startListenerSystems=function(){if(this.listenerSystemsActive)throw{name:"State error",message:"Not going to start listener systems--already active"};this.listenerSystems.forEach(function(e){e.start()}),this.listenerSystemsActive=!0},n.prototype.stopListenerSystems=function(){if(!this.listenerSystemsActive)throw{name:"State error",message:"Not going to stop listener systems--already inactive"};this.listenerSystems.forEach(function(e){e.stop()}),this.listenerSystemsActive=!1},t["default"]=n},function(e,t){"use strict";function n(e,t,n,i,o,r){this.pos={x:e,y:t},this.radius=n,this.a=i,this.b=o,this.speed=r,this.done={x:!1,y:!1},this.target=o}Object.defineProperty(t,"__esModule",{value:!0}),n.prototype.move=function(){var e={x:this.target.x-this.pos.x,y:this.target.y-this.pos.y},t={x:Math.abs(e.x),y:Math.abs(e.y)};["x","y"].forEach(function(n){t[n]<this.speed?(this.pos[n]=this.target[n],this.done[n]=!0):this.pos[n]+=this.speed*e[n]/t[n]}.bind(this)),this.done.x&&this.done.y&&(this.target=this.target===this.a?this.b:this.a,this.done.x=!1,this.done.y=!1)},n.render=function(e,t){e.save(),e.beginPath(),e.arc(0,0,t,0,2*Math.PI,!1),e.globalCompositeOperation="difference",e.fillStyle="#fff",e.fill(),e.closePath(),e.restore()},n.prototype.render=function(e){n.render(e,this.radius)},n.prototype.draw=function(e){e.save(),e.translate(this.pos.x,this.pos.y),this.render(e),e.restore()},t["default"]=n},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e,t,n,i){this.pos={},this.pos.x=e||0,this.pos.y=t||0,this.vel={},this.vel.x=0,this.vel.y=0,this.setSideLength(n||.5),this.rotation=i||0,this.setColor(new s["default"](255,255,255,1))}Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),s=i(r);o.prototype.getRadius=function(e){return this.halfSideLength/Math.max(Math.abs(Math.sin(e)),Math.abs(Math.cos(e)))},o.prototype.setSideLength=function(e){this.sideLength=e,this.halfSideLength=e/2},o.prototype.setColor=function(e){this.color=e,this.fillStyle=e.toString()},o.render=function(e,t,n,i){e.save(),e.rotate(i),e.fillStyle=n,e.fillRect(0,0,t,t),e.restore()},o.prototype.render=function(e){o.render(e,this.sideLength,this.fillStyle,this.rotation)},o.prototype.draw=function(e){e.save(),e.translate(this.pos.x-this.halfSideLength,this.pos.y-this.halfSideLength),this.render(e),e.restore()},t["default"]=o},function(e,t){"use strict";function n(e){this.work=e,this.interval=n.DEF_INTERVAL,this.maxIntervals=n.DEF_MAX_INTERVALS,this.time=0,this.totalTime=0}Object.defineProperty(t,"__esModule",{value:!0}),n.DEF_INTERVAL=20,n.DEF_MAX_INTERVALS=10,n.prototype.accumulate=function(e){this.time+=e,this.totalTime+=e},n.prototype["try"]=function(){for(var e=0;this.time>=this.interval&&e<this.maxIntervals;)this.time-=this.interval,e+=1,this.work()},n.prototype.go=function(e){this.accumulate(e),this["try"]()},n.prototype.reset=function(){this.time=0,this.totalTime=0},t["default"]=n},function(e,t){"use strict";function n(){}Object.defineProperty(t,"__esModule",{value:!0}),n["new"]=function(e,t){return{x:e,y:t}},n.clone=function(e){return{x:e.x,y:e.y}},n.distance=function(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},t["default"]=n}]);